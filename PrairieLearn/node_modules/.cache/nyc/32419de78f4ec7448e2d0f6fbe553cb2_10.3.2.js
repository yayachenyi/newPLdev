var cov_vnewx452k=function(){var path='/Users/fengyichen/pldev/newfolder/PrairieLearn/tests/helperDb.js',hash='f4963f7aded42969214e3e8071726b7c335f1729',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/fengyichen/pldev/newfolder/PrairieLearn/tests/helperDb.js',statementMap:{'0':{start:{line:1,column:10},end:{line:1,column:37}},'1':{start:{line:2,column:12},end:{line:2,column:28}},'2':{start:{line:3,column:9},end:{line:3,column:22}},'3':{start:{line:5,column:12},end:{line:5,column:35}},'4':{start:{line:6,column:17},end:{line:6,column:41}},'5':{start:{line:7,column:13},end:{line:7,column:33}},'6':{start:{line:8,column:11},end:{line:8,column:29}},'7':{start:{line:10,column:21},end:{line:10,column:31}},'8':{start:{line:11,column:25},end:{line:11,column:33}},'9':{start:{line:12,column:21},end:{line:12,column:32}},'10':{start:{line:13,column:20},end:{line:13,column:60}},'11':{start:{line:15,column:0},end:{line:184,column:2}},'12':{start:{line:19,column:8},end:{line:19,column:28}},'13':{start:{line:21,column:8},end:{line:82,column:11}},'14':{start:{line:23,column:16},end:{line:23,column:54}},'15':{start:{line:24,column:16},end:{line:27,column:19}},'16':{start:{line:25,column:20},end:{line:25,column:51}},'17':{start:{line:25,column:44},end:{line:25,column:51}},'18':{start:{line:26,column:20},end:{line:26,column:35}},'19':{start:{line:30,column:16},end:{line:33,column:19}},'20':{start:{line:31,column:20},end:{line:31,column:51}},'21':{start:{line:31,column:44},end:{line:31,column:51}},'22':{start:{line:32,column:20},end:{line:32,column:35}},'23':{start:{line:36,column:16},end:{line:39,column:19}},'24':{start:{line:37,column:20},end:{line:37,column:51}},'25':{start:{line:37,column:44},end:{line:37,column:51}},'26':{start:{line:38,column:20},end:{line:38,column:35}},'27':{start:{line:42,column:16},end:{line:42,column:29}},'28':{start:{line:43,column:16},end:{line:43,column:31}},'29':{start:{line:46,column:31},end:{line:52,column:17}},'30':{start:{line:53,column:39},end:{line:55,column:17}},'31':{start:{line:54,column:20},end:{line:54,column:58}},'32':{start:{line:56,column:16},end:{line:59,column:19}},'33':{start:{line:57,column:20},end:{line:57,column:51}},'34':{start:{line:57,column:44},end:{line:57,column:51}},'35':{start:{line:58,column:20},end:{line:58,column:35}},'36':{start:{line:62,column:16},end:{line:65,column:19}},'37':{start:{line:63,column:20},end:{line:63,column:51}},'38':{start:{line:63,column:44},end:{line:63,column:51}},'39':{start:{line:64,column:20},end:{line:64,column:35}},'40':{start:{line:68,column:16},end:{line:71,column:19}},'41':{start:{line:69,column:20},end:{line:69,column:51}},'42':{start:{line:69,column:44},end:{line:69,column:51}},'43':{start:{line:70,column:20},end:{line:70,column:35}},'44':{start:{line:74,column:16},end:{line:77,column:19}},'45':{start:{line:75,column:20},end:{line:75,column:51}},'46':{start:{line:75,column:44},end:{line:75,column:51}},'47':{start:{line:76,column:20},end:{line:76,column:35}},'48':{start:{line:80,column:12},end:{line:80,column:43}},'49':{start:{line:80,column:36},end:{line:80,column:43}},'50':{start:{line:81,column:12},end:{line:81,column:27}},'51':{start:{line:86,column:8},end:{line:86,column:28}},'52':{start:{line:88,column:8},end:{line:115,column:11}},'53':{start:{line:90,column:16},end:{line:93,column:19}},'54':{start:{line:91,column:20},end:{line:91,column:51}},'55':{start:{line:91,column:44},end:{line:91,column:51}},'56':{start:{line:92,column:20},end:{line:92,column:35}},'57':{start:{line:96,column:16},end:{line:96,column:54}},'58':{start:{line:97,column:16},end:{line:100,column:19}},'59':{start:{line:98,column:20},end:{line:98,column:51}},'60':{start:{line:98,column:44},end:{line:98,column:51}},'61':{start:{line:99,column:20},end:{line:99,column:35}},'62':{start:{line:103,column:16},end:{line:106,column:19}},'63':{start:{line:104,column:20},end:{line:104,column:51}},'64':{start:{line:104,column:44},end:{line:104,column:51}},'65':{start:{line:105,column:20},end:{line:105,column:35}},'66':{start:{line:109,column:16},end:{line:109,column:29}},'67':{start:{line:110,column:16},end:{line:110,column:31}},'68':{start:{line:113,column:12},end:{line:113,column:43}},'69':{start:{line:113,column:36},end:{line:113,column:43}},'70':{start:{line:114,column:12},end:{line:114,column:27}},'71':{start:{line:125,column:8},end:{line:125,column:28}},'72':{start:{line:127,column:8},end:{line:182,column:11}},'73':{start:{line:129,column:16},end:{line:129,column:54}},'74':{start:{line:130,column:16},end:{line:133,column:19}},'75':{start:{line:131,column:20},end:{line:131,column:51}},'76':{start:{line:131,column:44},end:{line:131,column:51}},'77':{start:{line:132,column:20},end:{line:132,column:35}},'78':{start:{line:136,column:16},end:{line:139,column:19}},'79':{start:{line:137,column:20},end:{line:137,column:51}},'80':{start:{line:137,column:44},end:{line:137,column:51}},'81':{start:{line:138,column:20},end:{line:138,column:35}},'82':{start:{line:142,column:16},end:{line:145,column:19}},'83':{start:{line:143,column:20},end:{line:143,column:51}},'84':{start:{line:143,column:44},end:{line:143,column:51}},'85':{start:{line:144,column:20},end:{line:144,column:35}},'86':{start:{line:148,column:16},end:{line:148,column:29}},'87':{start:{line:149,column:16},end:{line:149,column:31}},'88':{start:{line:152,column:31},end:{line:158,column:17}},'89':{start:{line:159,column:39},end:{line:161,column:17}},'90':{start:{line:160,column:20},end:{line:160,column:58}},'91':{start:{line:162,column:16},end:{line:165,column:19}},'92':{start:{line:163,column:20},end:{line:163,column:51}},'93':{start:{line:163,column:44},end:{line:163,column:51}},'94':{start:{line:164,column:20},end:{line:164,column:35}},'95':{start:{line:168,column:16},end:{line:171,column:19}},'96':{start:{line:169,column:20},end:{line:169,column:51}},'97':{start:{line:169,column:44},end:{line:169,column:51}},'98':{start:{line:170,column:20},end:{line:170,column:35}},'99':{start:{line:174,column:16},end:{line:177,column:19}},'100':{start:{line:175,column:20},end:{line:175,column:51}},'101':{start:{line:175,column:44},end:{line:175,column:51}},'102':{start:{line:176,column:20},end:{line:176,column:35}},'103':{start:{line:180,column:12},end:{line:180,column:43}},'104':{start:{line:180,column:36},end:{line:180,column:43}},'105':{start:{line:181,column:12},end:{line:181,column:27}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:16,column:12},end:{line:16,column:13}},loc:{start:{line:16,column:31},end:{line:83,column:5}},line:16},'1':{name:'(anonymous_1)',decl:{start:{line:22,column:12},end:{line:22,column:13}},loc:{start:{line:22,column:31},end:{line:28,column:13}},line:22},'2':{name:'(anonymous_2)',decl:{start:{line:24,column:31},end:{line:24,column:32}},loc:{start:{line:24,column:45},end:{line:27,column:17}},line:24},'3':{name:'(anonymous_3)',decl:{start:{line:29,column:12},end:{line:29,column:13}},loc:{start:{line:29,column:31},end:{line:34,column:13}},line:29},'4':{name:'(anonymous_4)',decl:{start:{line:30,column:84},end:{line:30,column:85}},loc:{start:{line:30,column:98},end:{line:33,column:17}},line:30},'5':{name:'(anonymous_5)',decl:{start:{line:35,column:12},end:{line:35,column:13}},loc:{start:{line:35,column:31},end:{line:40,column:13}},line:35},'6':{name:'(anonymous_6)',decl:{start:{line:36,column:76},end:{line:36,column:77}},loc:{start:{line:36,column:90},end:{line:39,column:17}},line:36},'7':{name:'(anonymous_7)',decl:{start:{line:41,column:12},end:{line:41,column:13}},loc:{start:{line:41,column:31},end:{line:44,column:13}},line:41},'8':{name:'(anonymous_8)',decl:{start:{line:45,column:12},end:{line:45,column:13}},loc:{start:{line:45,column:31},end:{line:60,column:13}},line:45},'9':{name:'(anonymous_9)',decl:{start:{line:53,column:39},end:{line:53,column:40}},loc:{start:{line:53,column:53},end:{line:55,column:17}},line:53},'10':{name:'(anonymous_10)',decl:{start:{line:56,column:55},end:{line:56,column:56}},loc:{start:{line:56,column:69},end:{line:59,column:17}},line:56},'11':{name:'(anonymous_11)',decl:{start:{line:61,column:12},end:{line:61,column:13}},loc:{start:{line:61,column:31},end:{line:66,column:13}},line:61},'12':{name:'(anonymous_12)',decl:{start:{line:62,column:32},end:{line:62,column:33}},loc:{start:{line:62,column:46},end:{line:65,column:17}},line:62},'13':{name:'(anonymous_13)',decl:{start:{line:67,column:12},end:{line:67,column:13}},loc:{start:{line:67,column:31},end:{line:72,column:13}},line:67},'14':{name:'(anonymous_14)',decl:{start:{line:68,column:28},end:{line:68,column:29}},loc:{start:{line:68,column:42},end:{line:71,column:17}},line:68},'15':{name:'(anonymous_15)',decl:{start:{line:73,column:12},end:{line:73,column:13}},loc:{start:{line:73,column:31},end:{line:78,column:13}},line:73},'16':{name:'(anonymous_16)',decl:{start:{line:74,column:26},end:{line:74,column:27}},loc:{start:{line:74,column:40},end:{line:77,column:17}},line:74},'17':{name:'(anonymous_17)',decl:{start:{line:79,column:11},end:{line:79,column:12}},loc:{start:{line:79,column:25},end:{line:82,column:9}},line:79},'18':{name:'(anonymous_18)',decl:{start:{line:85,column:11},end:{line:85,column:12}},loc:{start:{line:85,column:30},end:{line:116,column:5}},line:85},'19':{name:'(anonymous_19)',decl:{start:{line:89,column:12},end:{line:89,column:13}},loc:{start:{line:89,column:31},end:{line:94,column:13}},line:89},'20':{name:'(anonymous_20)',decl:{start:{line:90,column:28},end:{line:90,column:29}},loc:{start:{line:90,column:42},end:{line:93,column:17}},line:90},'21':{name:'(anonymous_21)',decl:{start:{line:95,column:12},end:{line:95,column:13}},loc:{start:{line:95,column:31},end:{line:101,column:13}},line:95},'22':{name:'(anonymous_22)',decl:{start:{line:97,column:31},end:{line:97,column:32}},loc:{start:{line:97,column:45},end:{line:100,column:17}},line:97},'23':{name:'(anonymous_23)',decl:{start:{line:102,column:12},end:{line:102,column:13}},loc:{start:{line:102,column:31},end:{line:107,column:13}},line:102},'24':{name:'(anonymous_24)',decl:{start:{line:103,column:84},end:{line:103,column:85}},loc:{start:{line:103,column:98},end:{line:106,column:17}},line:103},'25':{name:'(anonymous_25)',decl:{start:{line:108,column:12},end:{line:108,column:13}},loc:{start:{line:108,column:31},end:{line:111,column:13}},line:108},'26':{name:'(anonymous_26)',decl:{start:{line:112,column:11},end:{line:112,column:12}},loc:{start:{line:112,column:25},end:{line:115,column:9}},line:112},'27':{name:'(anonymous_27)',decl:{start:{line:122,column:22},end:{line:122,column:23}},loc:{start:{line:122,column:41},end:{line:183,column:5}},line:122},'28':{name:'(anonymous_28)',decl:{start:{line:128,column:12},end:{line:128,column:13}},loc:{start:{line:128,column:31},end:{line:134,column:13}},line:128},'29':{name:'(anonymous_29)',decl:{start:{line:130,column:31},end:{line:130,column:32}},loc:{start:{line:130,column:45},end:{line:133,column:17}},line:130},'30':{name:'(anonymous_30)',decl:{start:{line:135,column:12},end:{line:135,column:13}},loc:{start:{line:135,column:31},end:{line:140,column:13}},line:135},'31':{name:'(anonymous_31)',decl:{start:{line:136,column:84},end:{line:136,column:85}},loc:{start:{line:136,column:98},end:{line:139,column:17}},line:136},'32':{name:'(anonymous_32)',decl:{start:{line:141,column:12},end:{line:141,column:13}},loc:{start:{line:141,column:31},end:{line:146,column:13}},line:141},'33':{name:'(anonymous_33)',decl:{start:{line:142,column:76},end:{line:142,column:77}},loc:{start:{line:142,column:90},end:{line:145,column:17}},line:142},'34':{name:'(anonymous_34)',decl:{start:{line:147,column:12},end:{line:147,column:13}},loc:{start:{line:147,column:31},end:{line:150,column:13}},line:147},'35':{name:'(anonymous_35)',decl:{start:{line:151,column:12},end:{line:151,column:13}},loc:{start:{line:151,column:31},end:{line:166,column:13}},line:151},'36':{name:'(anonymous_36)',decl:{start:{line:159,column:39},end:{line:159,column:40}},loc:{start:{line:159,column:53},end:{line:161,column:17}},line:159},'37':{name:'(anonymous_37)',decl:{start:{line:162,column:55},end:{line:162,column:56}},loc:{start:{line:162,column:69},end:{line:165,column:17}},line:162},'38':{name:'(anonymous_38)',decl:{start:{line:167,column:12},end:{line:167,column:13}},loc:{start:{line:167,column:31},end:{line:172,column:13}},line:167},'39':{name:'(anonymous_39)',decl:{start:{line:168,column:32},end:{line:168,column:33}},loc:{start:{line:168,column:46},end:{line:171,column:17}},line:168},'40':{name:'(anonymous_40)',decl:{start:{line:173,column:12},end:{line:173,column:13}},loc:{start:{line:173,column:31},end:{line:178,column:13}},line:173},'41':{name:'(anonymous_41)',decl:{start:{line:174,column:28},end:{line:174,column:29}},loc:{start:{line:174,column:42},end:{line:177,column:17}},line:174},'42':{name:'(anonymous_42)',decl:{start:{line:179,column:11},end:{line:179,column:12}},loc:{start:{line:179,column:25},end:{line:182,column:9}},line:179}},branchMap:{'0':{loc:{start:{line:25,column:20},end:{line:25,column:51}},type:'if',locations:[{start:{line:25,column:20},end:{line:25,column:51}},{start:{line:25,column:20},end:{line:25,column:51}}],line:25},'1':{loc:{start:{line:31,column:20},end:{line:31,column:51}},type:'if',locations:[{start:{line:31,column:20},end:{line:31,column:51}},{start:{line:31,column:20},end:{line:31,column:51}}],line:31},'2':{loc:{start:{line:37,column:20},end:{line:37,column:51}},type:'if',locations:[{start:{line:37,column:20},end:{line:37,column:51}},{start:{line:37,column:20},end:{line:37,column:51}}],line:37},'3':{loc:{start:{line:57,column:20},end:{line:57,column:51}},type:'if',locations:[{start:{line:57,column:20},end:{line:57,column:51}},{start:{line:57,column:20},end:{line:57,column:51}}],line:57},'4':{loc:{start:{line:63,column:20},end:{line:63,column:51}},type:'if',locations:[{start:{line:63,column:20},end:{line:63,column:51}},{start:{line:63,column:20},end:{line:63,column:51}}],line:63},'5':{loc:{start:{line:69,column:20},end:{line:69,column:51}},type:'if',locations:[{start:{line:69,column:20},end:{line:69,column:51}},{start:{line:69,column:20},end:{line:69,column:51}}],line:69},'6':{loc:{start:{line:75,column:20},end:{line:75,column:51}},type:'if',locations:[{start:{line:75,column:20},end:{line:75,column:51}},{start:{line:75,column:20},end:{line:75,column:51}}],line:75},'7':{loc:{start:{line:80,column:12},end:{line:80,column:43}},type:'if',locations:[{start:{line:80,column:12},end:{line:80,column:43}},{start:{line:80,column:12},end:{line:80,column:43}}],line:80},'8':{loc:{start:{line:91,column:20},end:{line:91,column:51}},type:'if',locations:[{start:{line:91,column:20},end:{line:91,column:51}},{start:{line:91,column:20},end:{line:91,column:51}}],line:91},'9':{loc:{start:{line:98,column:20},end:{line:98,column:51}},type:'if',locations:[{start:{line:98,column:20},end:{line:98,column:51}},{start:{line:98,column:20},end:{line:98,column:51}}],line:98},'10':{loc:{start:{line:104,column:20},end:{line:104,column:51}},type:'if',locations:[{start:{line:104,column:20},end:{line:104,column:51}},{start:{line:104,column:20},end:{line:104,column:51}}],line:104},'11':{loc:{start:{line:113,column:12},end:{line:113,column:43}},type:'if',locations:[{start:{line:113,column:12},end:{line:113,column:43}},{start:{line:113,column:12},end:{line:113,column:43}}],line:113},'12':{loc:{start:{line:131,column:20},end:{line:131,column:51}},type:'if',locations:[{start:{line:131,column:20},end:{line:131,column:51}},{start:{line:131,column:20},end:{line:131,column:51}}],line:131},'13':{loc:{start:{line:137,column:20},end:{line:137,column:51}},type:'if',locations:[{start:{line:137,column:20},end:{line:137,column:51}},{start:{line:137,column:20},end:{line:137,column:51}}],line:137},'14':{loc:{start:{line:143,column:20},end:{line:143,column:51}},type:'if',locations:[{start:{line:143,column:20},end:{line:143,column:51}},{start:{line:143,column:20},end:{line:143,column:51}}],line:143},'15':{loc:{start:{line:163,column:20},end:{line:163,column:51}},type:'if',locations:[{start:{line:163,column:20},end:{line:163,column:51}},{start:{line:163,column:20},end:{line:163,column:51}}],line:163},'16':{loc:{start:{line:169,column:20},end:{line:169,column:51}},type:'if',locations:[{start:{line:169,column:20},end:{line:169,column:51}},{start:{line:169,column:20},end:{line:169,column:51}}],line:169},'17':{loc:{start:{line:175,column:20},end:{line:175,column:51}},type:'if',locations:[{start:{line:175,column:20},end:{line:175,column:51}},{start:{line:175,column:20},end:{line:175,column:51}}],line:175},'18':{loc:{start:{line:180,column:12},end:{line:180,column:43}},type:'if',locations:[{start:{line:180,column:12},end:{line:180,column:43}},{start:{line:180,column:12},end:{line:180,column:43}}],line:180}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0,'86':0,'87':0,'88':0,'89':0,'90':0,'91':0,'92':0,'93':0,'94':0,'95':0,'96':0,'97':0,'98':0,'99':0,'100':0,'101':0,'102':0,'103':0,'104':0,'105':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0],'11':[0,0],'12':[0,0],'13':[0,0],'14':[0,0],'15':[0,0],'16':[0,0],'17':[0,0],'18':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var ERR=(++cov_vnewx452k.s[0],require('async-stacktrace'));var async=(++cov_vnewx452k.s[1],require('async'));var pg=(++cov_vnewx452k.s[2],require('pg'));var sqldb=(++cov_vnewx452k.s[3],require('../lib/sqldb'));var migrations=(++cov_vnewx452k.s[4],require('../migrations'));var sprocs=(++cov_vnewx452k.s[5],require('../sprocs'));var cron=(++cov_vnewx452k.s[6],require('../cron'));var postgresqlUser=(++cov_vnewx452k.s[7],'postgres');var postgresqlDatabase=(++cov_vnewx452k.s[8],'pltest');var postgresqlHost=(++cov_vnewx452k.s[9],'localhost');var initConString=(++cov_vnewx452k.s[10],'postgres://postgres@localhost/postgres');++cov_vnewx452k.s[11];module.exports={before:function(callback){++cov_vnewx452k.f[0];++cov_vnewx452k.s[12];// long timeout because DROP DATABASE might take a long time to error
// if other processes have an open connection to that database
this.timeout(20000);var client;++cov_vnewx452k.s[13];async.series([function(callback){++cov_vnewx452k.f[1];++cov_vnewx452k.s[14];client=new pg.Client(initConString);++cov_vnewx452k.s[15];client.connect(function(err){++cov_vnewx452k.f[2];++cov_vnewx452k.s[16];if(ERR(err,callback)){++cov_vnewx452k.b[0][0];++cov_vnewx452k.s[17];return;}else{++cov_vnewx452k.b[0][1];}++cov_vnewx452k.s[18];callback(null);});},function(callback){++cov_vnewx452k.f[3];++cov_vnewx452k.s[19];client.query('DROP DATABASE IF EXISTS '+postgresqlDatabase+';',function(err){++cov_vnewx452k.f[4];++cov_vnewx452k.s[20];if(ERR(err,callback)){++cov_vnewx452k.b[1][0];++cov_vnewx452k.s[21];return;}else{++cov_vnewx452k.b[1][1];}++cov_vnewx452k.s[22];callback(null);});},function(callback){++cov_vnewx452k.f[5];++cov_vnewx452k.s[23];client.query('CREATE DATABASE '+postgresqlDatabase+';',function(err){++cov_vnewx452k.f[6];++cov_vnewx452k.s[24];if(ERR(err,callback)){++cov_vnewx452k.b[2][0];++cov_vnewx452k.s[25];return;}else{++cov_vnewx452k.b[2][1];}++cov_vnewx452k.s[26];callback(null);});},function(callback){++cov_vnewx452k.f[7];++cov_vnewx452k.s[27];client.end();++cov_vnewx452k.s[28];callback(null);},function(callback){++cov_vnewx452k.f[8];var pgConfig=(++cov_vnewx452k.s[29],{user:postgresqlUser,database:postgresqlDatabase,host:postgresqlHost,max:10,idleTimeoutMillis:30000});++cov_vnewx452k.s[30];var idleErrorHandler=function(err){++cov_vnewx452k.f[9];++cov_vnewx452k.s[31];throw Error('idle client error',err);};++cov_vnewx452k.s[32];sqldb.init(pgConfig,idleErrorHandler,function(err){++cov_vnewx452k.f[10];++cov_vnewx452k.s[33];if(ERR(err,callback)){++cov_vnewx452k.b[3][0];++cov_vnewx452k.s[34];return;}else{++cov_vnewx452k.b[3][1];}++cov_vnewx452k.s[35];callback(null);});},function(callback){++cov_vnewx452k.f[11];++cov_vnewx452k.s[36];migrations.init(function(err){++cov_vnewx452k.f[12];++cov_vnewx452k.s[37];if(ERR(err,callback)){++cov_vnewx452k.b[4][0];++cov_vnewx452k.s[38];return;}else{++cov_vnewx452k.b[4][1];}++cov_vnewx452k.s[39];callback(null);});},function(callback){++cov_vnewx452k.f[13];++cov_vnewx452k.s[40];sprocs.init(function(err){++cov_vnewx452k.f[14];++cov_vnewx452k.s[41];if(ERR(err,callback)){++cov_vnewx452k.b[5][0];++cov_vnewx452k.s[42];return;}else{++cov_vnewx452k.b[5][1];}++cov_vnewx452k.s[43];callback(null);});},function(callback){++cov_vnewx452k.f[15];++cov_vnewx452k.s[44];cron.init(function(err){++cov_vnewx452k.f[16];++cov_vnewx452k.s[45];if(ERR(err,callback)){++cov_vnewx452k.b[6][0];++cov_vnewx452k.s[46];return;}else{++cov_vnewx452k.b[6][1];}++cov_vnewx452k.s[47];callback(null);});}],function(err){++cov_vnewx452k.f[17];++cov_vnewx452k.s[48];if(ERR(err,callback)){++cov_vnewx452k.b[7][0];++cov_vnewx452k.s[49];return;}else{++cov_vnewx452k.b[7][1];}++cov_vnewx452k.s[50];callback(null);});},after:function(callback){++cov_vnewx452k.f[18];++cov_vnewx452k.s[51];this.timeout(20000);var client;++cov_vnewx452k.s[52];async.series([function(callback){++cov_vnewx452k.f[19];++cov_vnewx452k.s[53];sqldb.close(function(err){++cov_vnewx452k.f[20];++cov_vnewx452k.s[54];if(ERR(err,callback)){++cov_vnewx452k.b[8][0];++cov_vnewx452k.s[55];return;}else{++cov_vnewx452k.b[8][1];}++cov_vnewx452k.s[56];callback(null);});},function(callback){++cov_vnewx452k.f[21];++cov_vnewx452k.s[57];client=new pg.Client(initConString);++cov_vnewx452k.s[58];client.connect(function(err){++cov_vnewx452k.f[22];++cov_vnewx452k.s[59];if(ERR(err,callback)){++cov_vnewx452k.b[9][0];++cov_vnewx452k.s[60];return;}else{++cov_vnewx452k.b[9][1];}++cov_vnewx452k.s[61];callback(null);});},function(callback){++cov_vnewx452k.f[23];++cov_vnewx452k.s[62];client.query('DROP DATABASE IF EXISTS '+postgresqlDatabase+';',function(err){++cov_vnewx452k.f[24];++cov_vnewx452k.s[63];if(ERR(err,callback)){++cov_vnewx452k.b[10][0];++cov_vnewx452k.s[64];return;}else{++cov_vnewx452k.b[10][1];}++cov_vnewx452k.s[65];callback(null);});},function(callback){++cov_vnewx452k.f[25];++cov_vnewx452k.s[66];client.end();++cov_vnewx452k.s[67];callback(null);}],function(err){++cov_vnewx452k.f[26];++cov_vnewx452k.s[68];if(ERR(err,callback)){++cov_vnewx452k.b[11][0];++cov_vnewx452k.s[69];return;}else{++cov_vnewx452k.b[11][1];}++cov_vnewx452k.s[70];callback(null);});},// This version will only (re)create the database with migrations; it will
// then close the connection in sqldb. This is necessary for database
// schema verification, where databaseDiff will set up a connection to the
// desired database.
beforeOnlyCreate:function(callback){++cov_vnewx452k.f[27];++cov_vnewx452k.s[71];// long timeout because DROP DATABASE might take a long time to error
// if other processes have an open connection to that database
this.timeout(20000);var client;++cov_vnewx452k.s[72];async.series([function(callback){++cov_vnewx452k.f[28];++cov_vnewx452k.s[73];client=new pg.Client(initConString);++cov_vnewx452k.s[74];client.connect(function(err){++cov_vnewx452k.f[29];++cov_vnewx452k.s[75];if(ERR(err,callback)){++cov_vnewx452k.b[12][0];++cov_vnewx452k.s[76];return;}else{++cov_vnewx452k.b[12][1];}++cov_vnewx452k.s[77];callback(null);});},function(callback){++cov_vnewx452k.f[30];++cov_vnewx452k.s[78];client.query('DROP DATABASE IF EXISTS '+postgresqlDatabase+';',function(err){++cov_vnewx452k.f[31];++cov_vnewx452k.s[79];if(ERR(err,callback)){++cov_vnewx452k.b[13][0];++cov_vnewx452k.s[80];return;}else{++cov_vnewx452k.b[13][1];}++cov_vnewx452k.s[81];callback(null);});},function(callback){++cov_vnewx452k.f[32];++cov_vnewx452k.s[82];client.query('CREATE DATABASE '+postgresqlDatabase+';',function(err){++cov_vnewx452k.f[33];++cov_vnewx452k.s[83];if(ERR(err,callback)){++cov_vnewx452k.b[14][0];++cov_vnewx452k.s[84];return;}else{++cov_vnewx452k.b[14][1];}++cov_vnewx452k.s[85];callback(null);});},function(callback){++cov_vnewx452k.f[34];++cov_vnewx452k.s[86];client.end();++cov_vnewx452k.s[87];callback(null);},function(callback){++cov_vnewx452k.f[35];var pgConfig=(++cov_vnewx452k.s[88],{user:postgresqlUser,database:postgresqlDatabase,host:postgresqlHost,max:10,idleTimeoutMillis:30000});++cov_vnewx452k.s[89];var idleErrorHandler=function(err){++cov_vnewx452k.f[36];++cov_vnewx452k.s[90];throw Error('idle client error',err);};++cov_vnewx452k.s[91];sqldb.init(pgConfig,idleErrorHandler,function(err){++cov_vnewx452k.f[37];++cov_vnewx452k.s[92];if(ERR(err,callback)){++cov_vnewx452k.b[15][0];++cov_vnewx452k.s[93];return;}else{++cov_vnewx452k.b[15][1];}++cov_vnewx452k.s[94];callback(null);});},function(callback){++cov_vnewx452k.f[38];++cov_vnewx452k.s[95];migrations.init(function(err){++cov_vnewx452k.f[39];++cov_vnewx452k.s[96];if(ERR(err,callback)){++cov_vnewx452k.b[16][0];++cov_vnewx452k.s[97];return;}else{++cov_vnewx452k.b[16][1];}++cov_vnewx452k.s[98];callback(null);});},function(callback){++cov_vnewx452k.f[40];++cov_vnewx452k.s[99];sqldb.close(function(err){++cov_vnewx452k.f[41];++cov_vnewx452k.s[100];if(ERR(err,callback)){++cov_vnewx452k.b[17][0];++cov_vnewx452k.s[101];return;}else{++cov_vnewx452k.b[17][1];}++cov_vnewx452k.s[102];callback(null);});}],function(err){++cov_vnewx452k.f[42];++cov_vnewx452k.s[103];if(ERR(err,callback)){++cov_vnewx452k.b[18][0];++cov_vnewx452k.s[104];return;}else{++cov_vnewx452k.b[18][1];}++cov_vnewx452k.s[105];callback(null);});}};