var cov_1htbr4vqnm=function(){var path='/Users/fengyichen/pldev/newfolder/PrairieLearn/lib/server-jobs.js',hash='450710ca29aa3cd09587fd574e4793ad4f049e86',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/fengyichen/pldev/newfolder/PrairieLearn/lib/server-jobs.js',statementMap:{'0':{start:{line:1,column:10},end:{line:1,column:37}},'1':{start:{line:2,column:8},end:{line:2,column:25}},'2':{start:{line:3,column:12},end:{line:3,column:28}},'3':{start:{line:4,column:20},end:{line:4,column:44}},'4':{start:{line:6,column:13},end:{line:6,column:32}},'5':{start:{line:7,column:19},end:{line:7,column:45}},'6':{start:{line:8,column:12},end:{line:8,column:30}},'7':{start:{line:9,column:16},end:{line:9,column:39}},'8':{start:{line:11,column:10},end:{line:11,column:44}},'9':{start:{line:47,column:0},end:{line:52,column:2}},'10':{start:{line:57,column:4},end:{line:57,column:17}},'11':{start:{line:58,column:4},end:{line:58,column:27}},'12':{start:{line:59,column:4},end:{line:59,column:21}},'13':{start:{line:60,column:4},end:{line:60,column:21}},'14':{start:{line:61,column:4},end:{line:61,column:21}},'15':{start:{line:64,column:0},end:{line:69,column:2}},'16':{start:{line:65,column:4},end:{line:65,column:24}},'17':{start:{line:66,column:4},end:{line:66,column:24}},'18':{start:{line:67,column:4},end:{line:67,column:103}},'19':{start:{line:68,column:4},end:{line:68,column:103}},'20':{start:{line:71,column:0},end:{line:76,column:2}},'21':{start:{line:72,column:4},end:{line:72,column:24}},'22':{start:{line:73,column:4},end:{line:73,column:24}},'23':{start:{line:74,column:4},end:{line:74,column:103}},'24':{start:{line:75,column:4},end:{line:75,column:103}},'25':{start:{line:78,column:0},end:{line:80,column:2}},'26':{start:{line:79,column:4},end:{line:79,column:33}},'27':{start:{line:82,column:0},end:{line:84,column:2}},'28':{start:{line:83,column:4},end:{line:83,column:33}},'29':{start:{line:86,column:0},end:{line:88,column:2}},'30':{start:{line:87,column:4},end:{line:87,column:33}},'31':{start:{line:90,column:0},end:{line:92,column:2}},'32':{start:{line:91,column:4},end:{line:91,column:33}},'33':{start:{line:94,column:0},end:{line:96,column:2}},'34':{start:{line:98,column:0},end:{line:132,column:2}},'35':{start:{line:99,column:15},end:{line:99,column:19}},'36':{start:{line:100,column:17},end:{line:107,column:5}},'37':{start:{line:108,column:4},end:{line:131,column:7}},'38':{start:{line:109,column:8},end:{line:109,column:48}},'39':{start:{line:110,column:8},end:{line:110,column:60}},'40':{start:{line:111,column:8},end:{line:113,column:9}},'41':{start:{line:112,column:12},end:{line:112,column:93}},'42':{start:{line:114,column:8},end:{line:130,column:9}},'43':{start:{line:115,column:12},end:{line:115,column:80}},'44':{start:{line:116,column:12},end:{line:118,column:13}},'45':{start:{line:117,column:16},end:{line:117,column:52}},'46':{start:{line:120,column:25},end:{line:120,column:46}},'47':{start:{line:121,column:12},end:{line:129,column:13}},'48':{start:{line:122,column:16},end:{line:124,column:17}},'49':{start:{line:123,column:20},end:{line:123,column:53}},'50':{start:{line:126,column:16},end:{line:128,column:17}},'51':{start:{line:127,column:20},end:{line:127,column:91}},'52':{start:{line:134,column:0},end:{line:136,column:2}},'53':{start:{line:135,column:4},end:{line:135,column:25}},'54':{start:{line:138,column:0},end:{line:174,column:2}},'55':{start:{line:139,column:15},end:{line:139,column:19}},'56':{start:{line:140,column:17},end:{line:140,column:31}},'57':{start:{line:141,column:4},end:{line:141,column:29}},'58':{start:{line:142,column:4},end:{line:144,column:5}},'59':{start:{line:143,column:8},end:{line:143,column:43}},'60':{start:{line:145,column:4},end:{line:147,column:5}},'61':{start:{line:146,column:8},end:{line:146,column:72}},'62':{start:{line:148,column:17},end:{line:154,column:5}},'63':{start:{line:155,column:4},end:{line:173,column:7}},'64':{start:{line:156,column:8},end:{line:156,column:48}},'65':{start:{line:157,column:8},end:{line:157,column:60}},'66':{start:{line:158,column:8},end:{line:160,column:9}},'67':{start:{line:159,column:12},end:{line:159,column:93}},'68':{start:{line:161,column:8},end:{line:172,column:9}},'69':{start:{line:162,column:12},end:{line:162,column:80}},'70':{start:{line:163,column:12},end:{line:163,column:47}},'71':{start:{line:163,column:26},end:{line:163,column:47}},'72':{start:{line:164,column:12},end:{line:166,column:13}},'73':{start:{line:165,column:16},end:{line:165,column:52}},'74':{start:{line:168,column:12},end:{line:168,column:48}},'75':{start:{line:168,column:26},end:{line:168,column:48}},'76':{start:{line:169,column:12},end:{line:171,column:13}},'77':{start:{line:170,column:16},end:{line:170,column:52}},'78':{start:{line:178,column:0},end:{line:181,column:2}},'79':{start:{line:179,column:4},end:{line:179,column:54}},'80':{start:{line:180,column:4},end:{line:180,column:19}},'81':{start:{line:183,column:0},end:{line:227,column:2}},'82':{start:{line:184,column:4},end:{line:208,column:7}},'83':{start:{line:185,column:8},end:{line:188,column:9}},'84':{start:{line:186,column:12},end:{line:186,column:68}},'85':{start:{line:187,column:12},end:{line:187,column:19}},'86':{start:{line:190,column:8},end:{line:190,column:41}},'87':{start:{line:191,column:21},end:{line:193,column:9}},'88':{start:{line:194,column:8},end:{line:207,column:11}},'89':{start:{line:195,column:12},end:{line:195,column:104}},'90':{start:{line:195,column:21},end:{line:195,column:104}},'91':{start:{line:196,column:25},end:{line:196,column:46}},'92':{start:{line:197,column:25},end:{line:197,column:46}},'93':{start:{line:198,column:25},end:{line:198,column:46}},'94':{start:{line:199,column:25},end:{line:199,column:46}},'95':{start:{line:201,column:12},end:{line:205,column:13}},'96':{start:{line:202,column:16},end:{line:202,column:68}},'97':{start:{line:203,column:16},end:{line:203,column:68}},'98':{start:{line:204,column:16},end:{line:204,column:68}},'99':{start:{line:206,column:12},end:{line:206,column:87}},'100':{start:{line:210,column:4},end:{line:226,column:7}},'101':{start:{line:211,column:8},end:{line:214,column:9}},'102':{start:{line:212,column:12},end:{line:212,column:85}},'103':{start:{line:213,column:12},end:{line:213,column:19}},'104':{start:{line:216,column:8},end:{line:216,column:49}},'105':{start:{line:217,column:21},end:{line:219,column:9}},'106':{start:{line:220,column:8},end:{line:225,column:11}},'107':{start:{line:221,column:12},end:{line:221,column:130}},'108':{start:{line:221,column:21},end:{line:221,column:130}},'109':{start:{line:222,column:28},end:{line:222,column:52}},'110':{start:{line:224,column:12},end:{line:224,column:45}},'111':{start:{line:229,column:0},end:{line:272,column:2}},'112':{start:{line:230,column:4},end:{line:245,column:16}},'113':{start:{line:247,column:17},end:{line:260,column:5}},'114':{start:{line:261,column:4},end:{line:271,column:7}},'115':{start:{line:262,column:8},end:{line:262,column:39}},'116':{start:{line:262,column:32},end:{line:262,column:39}},'117':{start:{line:263,column:21},end:{line:263,column:38}},'118':{start:{line:265,column:18},end:{line:265,column:42}},'119':{start:{line:266,column:8},end:{line:266,column:46}},'120':{start:{line:267,column:8},end:{line:269,column:9}},'121':{start:{line:268,column:12},end:{line:268,column:92}},'122':{start:{line:270,column:8},end:{line:270,column:28}},'123':{start:{line:274,column:0},end:{line:297,column:2}},'124':{start:{line:275,column:4},end:{line:296,column:7}},'125':{start:{line:276,column:8},end:{line:276,column:39}},'126':{start:{line:276,column:32},end:{line:276,column:39}},'127':{start:{line:278,column:27},end:{line:278,column:63}},'128':{start:{line:279,column:8},end:{line:279,column:97}},'129':{start:{line:281,column:8},end:{line:281,column:44}},'130':{start:{line:282,column:8},end:{line:282,column:44}},'131':{start:{line:283,column:8},end:{line:283,column:76}},'132':{start:{line:283,column:51},end:{line:283,column:73}},'133':{start:{line:284,column:8},end:{line:284,column:76}},'134':{start:{line:284,column:51},end:{line:284,column:73}},'135':{start:{line:285,column:8},end:{line:285,column:105}},'136':{start:{line:285,column:51},end:{line:285,column:102}},'137':{start:{line:286,column:8},end:{line:286,column:102}},'138':{start:{line:286,column:48},end:{line:286,column:99}},'139':{start:{line:291,column:8},end:{line:291,column:75}},'140':{start:{line:292,column:8},end:{line:292,column:81}},'141':{start:{line:292,column:53},end:{line:292,column:78}},'142':{start:{line:293,column:8},end:{line:293,column:61}},'143':{start:{line:293,column:44},end:{line:293,column:58}},'144':{start:{line:295,column:8},end:{line:295,column:42}},'145':{start:{line:295,column:22},end:{line:295,column:42}},'146':{start:{line:299,column:0},end:{line:309,column:2}},'147':{start:{line:300,column:14},end:{line:300,column:45}},'148':{start:{line:301,column:4},end:{line:301,column:70}},'149':{start:{line:301,column:14},end:{line:301,column:70}},'150':{start:{line:302,column:4},end:{line:302,column:98}},'151':{start:{line:302,column:19},end:{line:302,column:98}},'152':{start:{line:303,column:4},end:{line:303,column:20}},'153':{start:{line:305,column:4},end:{line:308,column:7}},'154':{start:{line:306,column:8},end:{line:306,column:39}},'155':{start:{line:306,column:32},end:{line:306,column:39}},'156':{start:{line:307,column:8},end:{line:307,column:23}},'157':{start:{line:311,column:0},end:{line:347,column:2}},'158':{start:{line:312,column:4},end:{line:346,column:7}},'159':{start:{line:313,column:8},end:{line:313,column:39}},'160':{start:{line:313,column:32},end:{line:313,column:39}},'161':{start:{line:314,column:8},end:{line:345,column:11}},'162':{start:{line:315,column:12},end:{line:334,column:13}},'163':{start:{line:316,column:16},end:{line:316,column:71}},'164':{start:{line:317,column:29},end:{line:323,column:17}},'165':{start:{line:324,column:16},end:{line:333,column:19}},'166':{start:{line:325,column:20},end:{line:325,column:71}},'167':{start:{line:326,column:20},end:{line:328,column:21}},'168':{start:{line:327,column:24},end:{line:327,column:96}},'169':{start:{line:329,column:20},end:{line:331,column:21}},'170':{start:{line:330,column:24},end:{line:330,column:93}},'171':{start:{line:332,column:20},end:{line:332,column:35}},'172':{start:{line:336,column:12},end:{line:336,column:43}},'173':{start:{line:336,column:36},end:{line:336,column:43}},'174':{start:{line:338,column:12},end:{line:344,column:15}},'175':{start:{line:339,column:16},end:{line:339,column:47}},'176':{start:{line:339,column:40},end:{line:339,column:47}},'177':{start:{line:340,column:16},end:{line:342,column:19}},'178':{start:{line:341,column:20},end:{line:341,column:79}},'179':{start:{line:343,column:16},end:{line:343,column:31}},'180':{start:{line:349,column:0},end:{line:375,column:2}},'181':{start:{line:350,column:4},end:{line:358,column:16}},'182':{start:{line:360,column:17},end:{line:368,column:5}},'183':{start:{line:369,column:4},end:{line:374,column:7}},'184':{start:{line:370,column:8},end:{line:370,column:39}},'185':{start:{line:370,column:32},end:{line:370,column:39}},'186':{start:{line:371,column:30},end:{line:371,column:47}},'187':{start:{line:373,column:8},end:{line:373,column:40}},'188':{start:{line:377,column:0},end:{line:390,column:2}},'189':{start:{line:378,column:17},end:{line:380,column:5}},'190':{start:{line:381,column:4},end:{line:389,column:7}},'191':{start:{line:382,column:8},end:{line:382,column:76}},'192':{start:{line:383,column:8},end:{line:388,column:9}},'193':{start:{line:384,column:12},end:{line:384,column:98}},'194':{start:{line:385,column:12},end:{line:385,column:47}},'195':{start:{line:385,column:26},end:{line:385,column:47}},'196':{start:{line:387,column:12},end:{line:387,column:48}},'197':{start:{line:387,column:26},end:{line:387,column:48}}},fnMap:{'0':{name:'Job',decl:{start:{line:56,column:9},end:{line:56,column:12}},loc:{start:{line:56,column:26},end:{line:62,column:1}},line:56},'1':{name:'(anonymous_1)',decl:{start:{line:64,column:28},end:{line:64,column:29}},loc:{start:{line:64,column:43},end:{line:69,column:1}},line:64},'2':{name:'(anonymous_2)',decl:{start:{line:71,column:28},end:{line:71,column:29}},loc:{start:{line:71,column:43},end:{line:76,column:1}},line:71},'3':{name:'(anonymous_3)',decl:{start:{line:78,column:22},end:{line:78,column:23}},loc:{start:{line:78,column:36},end:{line:80,column:1}},line:78},'4':{name:'(anonymous_4)',decl:{start:{line:82,column:21},end:{line:82,column:22}},loc:{start:{line:82,column:35},end:{line:84,column:1}},line:82},'5':{name:'(anonymous_5)',decl:{start:{line:86,column:21},end:{line:86,column:22}},loc:{start:{line:86,column:35},end:{line:88,column:1}},line:86},'6':{name:'(anonymous_6)',decl:{start:{line:90,column:24},end:{line:90,column:25}},loc:{start:{line:90,column:38},end:{line:92,column:1}},line:90},'7':{name:'(anonymous_7)',decl:{start:{line:94,column:22},end:{line:94,column:23}},loc:{start:{line:94,column:37},end:{line:96,column:1}},line:94},'8':{name:'(anonymous_8)',decl:{start:{line:98,column:23},end:{line:98,column:24}},loc:{start:{line:98,column:46},end:{line:132,column:1}},line:98},'9':{name:'(anonymous_9)',decl:{start:{line:108,column:55},end:{line:108,column:56}},loc:{start:{line:108,column:77},end:{line:131,column:5}},line:108},'10':{name:'(anonymous_10)',decl:{start:{line:114,column:21},end:{line:114,column:22}},loc:{start:{line:114,column:32},end:{line:114,column:34}},line:114},'11':{name:'(anonymous_11)',decl:{start:{line:134,column:24},end:{line:134,column:25}},loc:{start:{line:134,column:35},end:{line:136,column:1}},line:134},'12':{name:'(anonymous_12)',decl:{start:{line:138,column:21},end:{line:138,column:22}},loc:{start:{line:138,column:45},end:{line:174,column:1}},line:138},'13':{name:'(anonymous_13)',decl:{start:{line:155,column:49},end:{line:155,column:50}},loc:{start:{line:155,column:72},end:{line:173,column:5}},line:155},'14':{name:'(anonymous_14)',decl:{start:{line:161,column:21},end:{line:161,column:22}},loc:{start:{line:161,column:32},end:{line:161,column:34}},line:161},'15':{name:'(anonymous_15)',decl:{start:{line:178,column:22},end:{line:178,column:23}},loc:{start:{line:178,column:41},end:{line:181,column:1}},line:178},'16':{name:'(anonymous_16)',decl:{start:{line:183,column:28},end:{line:183,column:29}},loc:{start:{line:183,column:45},end:{line:227,column:1}},line:183},'17':{name:'(anonymous_17)',decl:{start:{line:184,column:25},end:{line:184,column:26}},loc:{start:{line:184,column:49},end:{line:208,column:5}},line:184},'18':{name:'(anonymous_18)',decl:{start:{line:194,column:50},end:{line:194,column:51}},loc:{start:{line:194,column:72},end:{line:207,column:9}},line:194},'19':{name:'(anonymous_19)',decl:{start:{line:210,column:33},end:{line:210,column:34}},loc:{start:{line:210,column:57},end:{line:226,column:5}},line:210},'20':{name:'(anonymous_20)',decl:{start:{line:220,column:59},end:{line:220,column:60}},loc:{start:{line:220,column:81},end:{line:225,column:9}},line:220},'21':{name:'(anonymous_21)',decl:{start:{line:229,column:27},end:{line:229,column:28}},loc:{start:{line:229,column:55},end:{line:272,column:1}},line:229},'22':{name:'(anonymous_22)',decl:{start:{line:261,column:46},end:{line:261,column:47}},loc:{start:{line:261,column:68},end:{line:271,column:5}},line:261},'23':{name:'(anonymous_23)',decl:{start:{line:274,column:26},end:{line:274,column:27}},loc:{start:{line:274,column:54},end:{line:297,column:1}},line:274},'24':{name:'(anonymous_24)',decl:{start:{line:275,column:38},end:{line:275,column:39}},loc:{start:{line:275,column:57},end:{line:296,column:5}},line:275},'25':{name:'(anonymous_25)',decl:{start:{line:283,column:35},end:{line:283,column:36}},loc:{start:{line:283,column:50},end:{line:283,column:74}},line:283},'26':{name:'(anonymous_26)',decl:{start:{line:284,column:35},end:{line:284,column:36}},loc:{start:{line:284,column:50},end:{line:284,column:74}},line:284},'27':{name:'(anonymous_27)',decl:{start:{line:285,column:36},end:{line:285,column:37}},loc:{start:{line:285,column:50},end:{line:285,column:103}},line:285},'28':{name:'(anonymous_28)',decl:{start:{line:286,column:36},end:{line:286,column:37}},loc:{start:{line:286,column:47},end:{line:286,column:100}},line:286},'29':{name:'(anonymous_29)',decl:{start:{line:291,column:28},end:{line:291,column:29}},loc:{start:{line:291,column:53},end:{line:291,column:73}},line:291},'30':{name:'(anonymous_30)',decl:{start:{line:292,column:29},end:{line:292,column:30}},loc:{start:{line:292,column:52},end:{line:292,column:79}},line:292},'31':{name:'(anonymous_31)',decl:{start:{line:293,column:29},end:{line:293,column:30}},loc:{start:{line:293,column:43},end:{line:293,column:59}},line:293},'32':{name:'(anonymous_32)',decl:{start:{line:299,column:25},end:{line:299,column:26}},loc:{start:{line:299,column:52},end:{line:309,column:1}},line:299},'33':{name:'(anonymous_33)',decl:{start:{line:305,column:31},end:{line:305,column:32}},loc:{start:{line:305,column:45},end:{line:308,column:5}},line:305},'34':{name:'(anonymous_34)',decl:{start:{line:311,column:36},end:{line:311,column:37}},loc:{start:{line:311,column:55},end:{line:347,column:1}},line:311},'35':{name:'(anonymous_35)',decl:{start:{line:312,column:45},end:{line:312,column:46}},loc:{start:{line:312,column:67},end:{line:346,column:5}},line:312},'36':{name:'(anonymous_36)',decl:{start:{line:314,column:32},end:{line:314,column:33}},loc:{start:{line:314,column:56},end:{line:335,column:9}},line:314},'37':{name:'(anonymous_37)',decl:{start:{line:324,column:61},end:{line:324,column:62}},loc:{start:{line:324,column:84},end:{line:333,column:17}},line:324},'38':{name:'(anonymous_38)',decl:{start:{line:329,column:33},end:{line:329,column:34}},loc:{start:{line:329,column:44},end:{line:329,column:46}},line:329},'39':{name:'(anonymous_39)',decl:{start:{line:335,column:11},end:{line:335,column:12}},loc:{start:{line:335,column:25},end:{line:345,column:9}},line:335},'40':{name:'(anonymous_40)',decl:{start:{line:338,column:63},end:{line:338,column:64}},loc:{start:{line:338,column:85},end:{line:344,column:13}},line:338},'41':{name:'(anonymous_41)',decl:{start:{line:340,column:36},end:{line:340,column:37}},loc:{start:{line:340,column:50},end:{line:342,column:17}},line:340},'42':{name:'(anonymous_42)',decl:{start:{line:349,column:35},end:{line:349,column:36}},loc:{start:{line:349,column:63},end:{line:375,column:1}},line:349},'43':{name:'(anonymous_43)',decl:{start:{line:369,column:55},end:{line:369,column:56}},loc:{start:{line:369,column:77},end:{line:374,column:5}},line:369},'44':{name:'(anonymous_44)',decl:{start:{line:377,column:33},end:{line:377,column:34}},loc:{start:{line:377,column:69},end:{line:390,column:1}},line:377},'45':{name:'(anonymous_45)',decl:{start:{line:381,column:47},end:{line:381,column:48}},loc:{start:{line:381,column:70},end:{line:389,column:5}},line:381},'46':{name:'(anonymous_46)',decl:{start:{line:383,column:21},end:{line:383,column:22}},loc:{start:{line:383,column:27},end:{line:383,column:29}},line:383}},branchMap:{'0':{loc:{start:{line:111,column:8},end:{line:113,column:9}},type:'if',locations:[{start:{line:111,column:8},end:{line:113,column:9}},{start:{line:111,column:8},end:{line:113,column:9}}],line:111},'1':{loc:{start:{line:114,column:8},end:{line:130,column:9}},type:'if',locations:[{start:{line:114,column:8},end:{line:130,column:9}},{start:{line:114,column:8},end:{line:130,column:9}}],line:114},'2':{loc:{start:{line:116,column:12},end:{line:118,column:13}},type:'if',locations:[{start:{line:116,column:12},end:{line:118,column:13}},{start:{line:116,column:12},end:{line:118,column:13}}],line:116},'3':{loc:{start:{line:121,column:12},end:{line:129,column:13}},type:'if',locations:[{start:{line:121,column:12},end:{line:129,column:13}},{start:{line:121,column:12},end:{line:129,column:13}}],line:121},'4':{loc:{start:{line:122,column:16},end:{line:124,column:17}},type:'if',locations:[{start:{line:122,column:16},end:{line:124,column:17}},{start:{line:122,column:16},end:{line:124,column:17}}],line:122},'5':{loc:{start:{line:126,column:16},end:{line:128,column:17}},type:'if',locations:[{start:{line:126,column:16},end:{line:128,column:17}},{start:{line:126,column:16},end:{line:128,column:17}}],line:126},'6':{loc:{start:{line:142,column:4},end:{line:144,column:5}},type:'if',locations:[{start:{line:142,column:4},end:{line:144,column:5}},{start:{line:142,column:4},end:{line:144,column:5}}],line:142},'7':{loc:{start:{line:145,column:4},end:{line:147,column:5}},type:'if',locations:[{start:{line:145,column:4},end:{line:147,column:5}},{start:{line:145,column:4},end:{line:147,column:5}}],line:145},'8':{loc:{start:{line:158,column:8},end:{line:160,column:9}},type:'if',locations:[{start:{line:158,column:8},end:{line:160,column:9}},{start:{line:158,column:8},end:{line:160,column:9}}],line:158},'9':{loc:{start:{line:161,column:8},end:{line:172,column:9}},type:'if',locations:[{start:{line:161,column:8},end:{line:172,column:9}},{start:{line:161,column:8},end:{line:172,column:9}}],line:161},'10':{loc:{start:{line:163,column:12},end:{line:163,column:47}},type:'if',locations:[{start:{line:163,column:12},end:{line:163,column:47}},{start:{line:163,column:12},end:{line:163,column:47}}],line:163},'11':{loc:{start:{line:164,column:12},end:{line:166,column:13}},type:'if',locations:[{start:{line:164,column:12},end:{line:166,column:13}},{start:{line:164,column:12},end:{line:166,column:13}}],line:164},'12':{loc:{start:{line:168,column:12},end:{line:168,column:48}},type:'if',locations:[{start:{line:168,column:12},end:{line:168,column:48}},{start:{line:168,column:12},end:{line:168,column:48}}],line:168},'13':{loc:{start:{line:169,column:12},end:{line:171,column:13}},type:'if',locations:[{start:{line:169,column:12},end:{line:171,column:13}},{start:{line:169,column:12},end:{line:171,column:13}}],line:169},'14':{loc:{start:{line:185,column:8},end:{line:188,column:9}},type:'if',locations:[{start:{line:185,column:8},end:{line:188,column:9}},{start:{line:185,column:8},end:{line:188,column:9}}],line:185},'15':{loc:{start:{line:195,column:12},end:{line:195,column:104}},type:'if',locations:[{start:{line:195,column:12},end:{line:195,column:104}},{start:{line:195,column:12},end:{line:195,column:104}}],line:195},'16':{loc:{start:{line:201,column:12},end:{line:205,column:13}},type:'if',locations:[{start:{line:201,column:12},end:{line:205,column:13}},{start:{line:201,column:12},end:{line:205,column:13}}],line:201},'17':{loc:{start:{line:211,column:8},end:{line:214,column:9}},type:'if',locations:[{start:{line:211,column:8},end:{line:214,column:9}},{start:{line:211,column:8},end:{line:214,column:9}}],line:211},'18':{loc:{start:{line:221,column:12},end:{line:221,column:130}},type:'if',locations:[{start:{line:221,column:12},end:{line:221,column:130}},{start:{line:221,column:12},end:{line:221,column:130}}],line:221},'19':{loc:{start:{line:262,column:8},end:{line:262,column:39}},type:'if',locations:[{start:{line:262,column:8},end:{line:262,column:39}},{start:{line:262,column:8},end:{line:262,column:39}}],line:262},'20':{loc:{start:{line:267,column:8},end:{line:269,column:9}},type:'if',locations:[{start:{line:267,column:8},end:{line:269,column:9}},{start:{line:267,column:8},end:{line:269,column:9}}],line:267},'21':{loc:{start:{line:276,column:8},end:{line:276,column:39}},type:'if',locations:[{start:{line:276,column:8},end:{line:276,column:39}},{start:{line:276,column:8},end:{line:276,column:39}}],line:276},'22':{loc:{start:{line:295,column:8},end:{line:295,column:42}},type:'if',locations:[{start:{line:295,column:8},end:{line:295,column:42}},{start:{line:295,column:8},end:{line:295,column:42}}],line:295},'23':{loc:{start:{line:301,column:4},end:{line:301,column:70}},type:'if',locations:[{start:{line:301,column:4},end:{line:301,column:70}},{start:{line:301,column:4},end:{line:301,column:70}}],line:301},'24':{loc:{start:{line:302,column:4},end:{line:302,column:98}},type:'if',locations:[{start:{line:302,column:4},end:{line:302,column:98}},{start:{line:302,column:4},end:{line:302,column:98}}],line:302},'25':{loc:{start:{line:306,column:8},end:{line:306,column:39}},type:'if',locations:[{start:{line:306,column:8},end:{line:306,column:39}},{start:{line:306,column:8},end:{line:306,column:39}}],line:306},'26':{loc:{start:{line:313,column:8},end:{line:313,column:39}},type:'if',locations:[{start:{line:313,column:8},end:{line:313,column:39}},{start:{line:313,column:8},end:{line:313,column:39}}],line:313},'27':{loc:{start:{line:315,column:12},end:{line:334,column:13}},type:'if',locations:[{start:{line:315,column:12},end:{line:334,column:13}},{start:{line:315,column:12},end:{line:334,column:13}}],line:315},'28':{loc:{start:{line:326,column:20},end:{line:328,column:21}},type:'if',locations:[{start:{line:326,column:20},end:{line:328,column:21}},{start:{line:326,column:20},end:{line:328,column:21}}],line:326},'29':{loc:{start:{line:329,column:20},end:{line:331,column:21}},type:'if',locations:[{start:{line:329,column:20},end:{line:331,column:21}},{start:{line:329,column:20},end:{line:331,column:21}}],line:329},'30':{loc:{start:{line:336,column:12},end:{line:336,column:43}},type:'if',locations:[{start:{line:336,column:12},end:{line:336,column:43}},{start:{line:336,column:12},end:{line:336,column:43}}],line:336},'31':{loc:{start:{line:339,column:16},end:{line:339,column:47}},type:'if',locations:[{start:{line:339,column:16},end:{line:339,column:47}},{start:{line:339,column:16},end:{line:339,column:47}}],line:339},'32':{loc:{start:{line:370,column:8},end:{line:370,column:39}},type:'if',locations:[{start:{line:370,column:8},end:{line:370,column:39}},{start:{line:370,column:8},end:{line:370,column:39}}],line:370},'33':{loc:{start:{line:383,column:8},end:{line:388,column:9}},type:'if',locations:[{start:{line:383,column:8},end:{line:388,column:9}},{start:{line:383,column:8},end:{line:388,column:9}}],line:383},'34':{loc:{start:{line:385,column:12},end:{line:385,column:47}},type:'if',locations:[{start:{line:385,column:12},end:{line:385,column:47}},{start:{line:385,column:12},end:{line:385,column:47}}],line:385},'35':{loc:{start:{line:387,column:12},end:{line:387,column:48}},type:'if',locations:[{start:{line:387,column:12},end:{line:387,column:48}},{start:{line:387,column:12},end:{line:387,column:48}}],line:387}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0,'86':0,'87':0,'88':0,'89':0,'90':0,'91':0,'92':0,'93':0,'94':0,'95':0,'96':0,'97':0,'98':0,'99':0,'100':0,'101':0,'102':0,'103':0,'104':0,'105':0,'106':0,'107':0,'108':0,'109':0,'110':0,'111':0,'112':0,'113':0,'114':0,'115':0,'116':0,'117':0,'118':0,'119':0,'120':0,'121':0,'122':0,'123':0,'124':0,'125':0,'126':0,'127':0,'128':0,'129':0,'130':0,'131':0,'132':0,'133':0,'134':0,'135':0,'136':0,'137':0,'138':0,'139':0,'140':0,'141':0,'142':0,'143':0,'144':0,'145':0,'146':0,'147':0,'148':0,'149':0,'150':0,'151':0,'152':0,'153':0,'154':0,'155':0,'156':0,'157':0,'158':0,'159':0,'160':0,'161':0,'162':0,'163':0,'164':0,'165':0,'166':0,'167':0,'168':0,'169':0,'170':0,'171':0,'172':0,'173':0,'174':0,'175':0,'176':0,'177':0,'178':0,'179':0,'180':0,'181':0,'182':0,'183':0,'184':0,'185':0,'186':0,'187':0,'188':0,'189':0,'190':0,'191':0,'192':0,'193':0,'194':0,'195':0,'196':0,'197':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0],'11':[0,0],'12':[0,0],'13':[0,0],'14':[0,0],'15':[0,0],'16':[0,0],'17':[0,0],'18':[0,0],'19':[0,0],'20':[0,0],'21':[0,0],'22':[0,0],'23':[0,0],'24':[0,0],'25':[0,0],'26':[0,0],'27':[0,0],'28':[0,0],'29':[0,0],'30':[0,0],'31':[0,0],'32':[0,0],'33':[0,0],'34':[0,0],'35':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var ERR=(++cov_1htbr4vqnm.s[0],require('async-stacktrace'));var _=(++cov_1htbr4vqnm.s[1],require('lodash'));var async=(++cov_1htbr4vqnm.s[2],require('async'));var child_process=(++cov_1htbr4vqnm.s[3],require('child_process'));var logger=(++cov_1htbr4vqnm.s[4],require('./logger'));var socketServer=(++cov_1htbr4vqnm.s[5],require('./socket-server'));var sqldb=(++cov_1htbr4vqnm.s[6],require('./sqldb'));var sqlLoader=(++cov_1htbr4vqnm.s[7],require('./sql-loader'));var sql=(++cov_1htbr4vqnm.s[8],sqlLoader.loadSqlEquiv(__filename));/*
  SocketIO configuration

  ##########################################
  Room 'job-231' for job_id = 231 in DB.

  Receives messages:
  'joinJob', arguments: job_id, returns: status, stderr, stdout, output

  Sends messages:
  'change:stderr', arguments: job_id, stderr
  'change:stdout', arguments: job_id, stdout
  'change:output', arguments: job_id, output
  'update', arguments: job_id

  ##########################################
  Room 'jobSequence-593' for job_sequence_id = 593 in DB.

  Receives messages:
  'joinJobSequence', arguments: job_sequence_id, returns: job_count

  Sends messages:
  'update', arguments: job_sequence_id

  ##########################################

  'update' events are sent for bulk changes to the object when
  there is no specific 'change' event available.

  For example, an 'update' will not be sent when stderr changes
  because the more specific 'change:stderr' event will be sent
  instead.
*/++cov_1htbr4vqnm.s[9];module.exports={// Store currently active job information in memory. This is used
// to accumulate stderr/stdout, which are only written to the DB
// once the job is finished.
liveJobs:{}};/********************************************************************/function Job(id,options){++cov_1htbr4vqnm.f[0];++cov_1htbr4vqnm.s[10];this.id=id;++cov_1htbr4vqnm.s[11];this.options=options;++cov_1htbr4vqnm.s[12];this.stderr='';++cov_1htbr4vqnm.s[13];this.stdout='';++cov_1htbr4vqnm.s[14];this.output='';}++cov_1htbr4vqnm.s[15];Job.prototype.addToStderr=function(text){++cov_1htbr4vqnm.f[1];++cov_1htbr4vqnm.s[16];this.stderr+=text;++cov_1htbr4vqnm.s[17];this.output+=text;++cov_1htbr4vqnm.s[18];socketServer.io.to('job-'+this.id).emit('change:stderr',{job_id:this.id,stderr:this.stderr});++cov_1htbr4vqnm.s[19];socketServer.io.to('job-'+this.id).emit('change:output',{job_id:this.id,output:this.output});};++cov_1htbr4vqnm.s[20];Job.prototype.addToStdout=function(text){++cov_1htbr4vqnm.f[2];++cov_1htbr4vqnm.s[21];this.stdout+=text;++cov_1htbr4vqnm.s[22];this.output+=text;++cov_1htbr4vqnm.s[23];socketServer.io.to('job-'+this.id).emit('change:stdout',{job_id:this.id,stdout:this.stdout});++cov_1htbr4vqnm.s[24];socketServer.io.to('job-'+this.id).emit('change:output',{job_id:this.id,output:this.output});};++cov_1htbr4vqnm.s[25];Job.prototype.error=function(msg){++cov_1htbr4vqnm.f[3];++cov_1htbr4vqnm.s[26];this.addToStderr(msg+'\n');};++cov_1htbr4vqnm.s[27];Job.prototype.warn=function(msg){++cov_1htbr4vqnm.f[4];++cov_1htbr4vqnm.s[28];this.addToStdout(msg+'\n');};++cov_1htbr4vqnm.s[29];Job.prototype.info=function(msg){++cov_1htbr4vqnm.f[5];++cov_1htbr4vqnm.s[30];this.addToStdout(msg+'\n');};++cov_1htbr4vqnm.s[31];Job.prototype.verbose=function(msg){++cov_1htbr4vqnm.f[6];++cov_1htbr4vqnm.s[32];this.addToStdout(msg+'\n');};++cov_1htbr4vqnm.s[33];Job.prototype.debug=function(_msg){// do nothing
++cov_1htbr4vqnm.f[7];};++cov_1htbr4vqnm.s[34];Job.prototype.finish=function(code,signal){++cov_1htbr4vqnm.f[8];var that=(++cov_1htbr4vqnm.s[35],this);var params=(++cov_1htbr4vqnm.s[36],{job_id:that.id,stderr:that.stderr,stdout:that.stdout,output:that.output,exit_code:code,exit_signal:signal});++cov_1htbr4vqnm.s[37];sqldb.queryOneRow(sql.update_job_on_close,params,function(err,result){++cov_1htbr4vqnm.f[9];++cov_1htbr4vqnm.s[38];delete module.exports.liveJobs[that.id];++cov_1htbr4vqnm.s[39];socketServer.io.to('job-'+that.id).emit('update');++cov_1htbr4vqnm.s[40];if(that.options.job_sequence_id!=null){++cov_1htbr4vqnm.b[0][0];++cov_1htbr4vqnm.s[41];socketServer.io.to('jobSequence-'+that.options.job_sequence_id).emit('update');}else{++cov_1htbr4vqnm.b[0][1];}++cov_1htbr4vqnm.s[42];if(ERR(err,function(){++cov_1htbr4vqnm.f[10];})){++cov_1htbr4vqnm.b[1][0];++cov_1htbr4vqnm.s[43];logger.error('error updating job_id '+that.id+' on close',err);++cov_1htbr4vqnm.s[44];if(that.options.on_error){++cov_1htbr4vqnm.b[2][0];++cov_1htbr4vqnm.s[45];that.options.on_error(that.id,err);}else{++cov_1htbr4vqnm.b[2][1];}}else{++cov_1htbr4vqnm.b[1][1];var status=(++cov_1htbr4vqnm.s[46],result.rows[0].status);++cov_1htbr4vqnm.s[47];if(status=='Success'){++cov_1htbr4vqnm.b[3][0];++cov_1htbr4vqnm.s[48];if(that.options.on_success){++cov_1htbr4vqnm.b[4][0];++cov_1htbr4vqnm.s[49];that.options.on_success(that.id);}else{++cov_1htbr4vqnm.b[4][1];}}else{++cov_1htbr4vqnm.b[3][1];++cov_1htbr4vqnm.s[50];if(that.options.on_error){++cov_1htbr4vqnm.b[5][0];++cov_1htbr4vqnm.s[51];that.options.on_error(that.id,new Error('Job terminated with error'));}else{++cov_1htbr4vqnm.b[5][1];}}}});};++cov_1htbr4vqnm.s[52];Job.prototype.succeed=function(){++cov_1htbr4vqnm.f[11];++cov_1htbr4vqnm.s[53];this.finish(0,null);};++cov_1htbr4vqnm.s[54];Job.prototype.fail=function(err,callback){++cov_1htbr4vqnm.f[12];var that=(++cov_1htbr4vqnm.s[55],this);var errMsg=(++cov_1htbr4vqnm.s[56],err.toString());++cov_1htbr4vqnm.s[57];that.addToStderr(errMsg);++cov_1htbr4vqnm.s[58];if(_.has(err,'stack')){++cov_1htbr4vqnm.b[6][0];++cov_1htbr4vqnm.s[59];that.addToStderr('\n'+err.stack);}else{++cov_1htbr4vqnm.b[6][1];}++cov_1htbr4vqnm.s[60];if(_.has(err,'data')){++cov_1htbr4vqnm.b[7][0];++cov_1htbr4vqnm.s[61];that.addToStderr('\n'+JSON.stringify(err.data,null,'    '));}else{++cov_1htbr4vqnm.b[7][1];}var params=(++cov_1htbr4vqnm.s[62],{job_id:that.id,stderr:that.stderr,stdout:that.stdout,output:that.output,error_message:errMsg});++cov_1htbr4vqnm.s[63];sqldb.query(sql.update_job_on_error,params,function(err,_result){++cov_1htbr4vqnm.f[13];++cov_1htbr4vqnm.s[64];delete module.exports.liveJobs[that.id];++cov_1htbr4vqnm.s[65];socketServer.io.to('job-'+that.id).emit('update');++cov_1htbr4vqnm.s[66];if(that.options.job_sequence_id!=null){++cov_1htbr4vqnm.b[8][0];++cov_1htbr4vqnm.s[67];socketServer.io.to('jobSequence-'+that.options.job_sequence_id).emit('update');}else{++cov_1htbr4vqnm.b[8][1];}++cov_1htbr4vqnm.s[68];if(ERR(err,function(){++cov_1htbr4vqnm.f[14];})){++cov_1htbr4vqnm.b[9][0];++cov_1htbr4vqnm.s[69];logger.error('error updating job_id '+that.id+' on error',err);++cov_1htbr4vqnm.s[70];if(callback){++cov_1htbr4vqnm.b[10][0];++cov_1htbr4vqnm.s[71];return callback(err);}else{++cov_1htbr4vqnm.b[10][1];}++cov_1htbr4vqnm.s[72];if(that.options.on_error){++cov_1htbr4vqnm.b[11][0];++cov_1htbr4vqnm.s[73];that.options.on_error(that.id,err);}else{++cov_1htbr4vqnm.b[11][1];}}else{++cov_1htbr4vqnm.b[9][1];++cov_1htbr4vqnm.s[74];if(callback){++cov_1htbr4vqnm.b[12][0];++cov_1htbr4vqnm.s[75];return callback(null);}else{++cov_1htbr4vqnm.b[12][1];}++cov_1htbr4vqnm.s[76];if(that.options.on_error){++cov_1htbr4vqnm.b[13][0];++cov_1htbr4vqnm.s[77];that.options.on_error(that.id,err);}else{++cov_1htbr4vqnm.b[13][1];}}});};/********************************************************************/++cov_1htbr4vqnm.s[78];module.exports.init=function(callback){++cov_1htbr4vqnm.f[15];++cov_1htbr4vqnm.s[79];socketServer.io.on('connection',this.connection);++cov_1htbr4vqnm.s[80];callback(null);};++cov_1htbr4vqnm.s[81];module.exports.connection=function(socket){++cov_1htbr4vqnm.f[16];++cov_1htbr4vqnm.s[82];socket.on('joinJob',function(msg,callback){++cov_1htbr4vqnm.f[17];++cov_1htbr4vqnm.s[83];if(!_.has(msg,'job_id')){++cov_1htbr4vqnm.b[14][0];++cov_1htbr4vqnm.s[84];logger.error('socket.io joinJob called without job_id');++cov_1htbr4vqnm.s[85];return;}else{++cov_1htbr4vqnm.b[14][1];}// FIXME: check authn/authz with socket.request
++cov_1htbr4vqnm.s[86];socket.join('job-'+msg.job_id);var params=(++cov_1htbr4vqnm.s[87],{job_id:msg.job_id});++cov_1htbr4vqnm.s[88];sqldb.queryOneRow(sql.select_job,params,function(err,result){++cov_1htbr4vqnm.f[18];++cov_1htbr4vqnm.s[89];if(err){++cov_1htbr4vqnm.b[15][0];++cov_1htbr4vqnm.s[90];return logger.error('socket.io joinJob error selecting job_id '+msg.job_id,err);}else{++cov_1htbr4vqnm.b[15][1];}var status=(++cov_1htbr4vqnm.s[91],result.rows[0].status);var stderr=(++cov_1htbr4vqnm.s[92],result.rows[0].stderr);var stdout=(++cov_1htbr4vqnm.s[93],result.rows[0].stdout);var output=(++cov_1htbr4vqnm.s[94],result.rows[0].output);++cov_1htbr4vqnm.s[95];if(module.exports.liveJobs[msg.job_id]){++cov_1htbr4vqnm.b[16][0];++cov_1htbr4vqnm.s[96];stderr=module.exports.liveJobs[msg.job_id].stderr;++cov_1htbr4vqnm.s[97];stdout=module.exports.liveJobs[msg.job_id].stdout;++cov_1htbr4vqnm.s[98];output=module.exports.liveJobs[msg.job_id].output;}else{++cov_1htbr4vqnm.b[16][1];}++cov_1htbr4vqnm.s[99];callback({status:status,stderr:stderr,stdout:stdout,output:output});});});++cov_1htbr4vqnm.s[100];socket.on('joinJobSequence',function(msg,callback){++cov_1htbr4vqnm.f[19];++cov_1htbr4vqnm.s[101];if(!_.has(msg,'job_sequence_id')){++cov_1htbr4vqnm.b[17][0];++cov_1htbr4vqnm.s[102];logger.error('socket.io joinJobSequence called without job_sequence_id');++cov_1htbr4vqnm.s[103];return;}else{++cov_1htbr4vqnm.b[17][1];}// FIXME: check authn/authz with socket.request
++cov_1htbr4vqnm.s[104];socket.join('jobSequence-'+msg.job_id);var params=(++cov_1htbr4vqnm.s[105],{job_sequence_id:msg.job_sequence_id});++cov_1htbr4vqnm.s[106];sqldb.queryOneRow(sql.select_job_sequence,params,function(err,result){++cov_1htbr4vqnm.f[20];++cov_1htbr4vqnm.s[107];if(err){++cov_1htbr4vqnm.b[18][0];++cov_1htbr4vqnm.s[108];return logger.error('socket.io joinJobSequence error selecting job_sequence_id '+msg.job_sequence_id,err);}else{++cov_1htbr4vqnm.b[18][1];}var job_count=(++cov_1htbr4vqnm.s[109],result.rows[0].job_count);++cov_1htbr4vqnm.s[110];callback({job_count:job_count});});});};++cov_1htbr4vqnm.s[111];module.exports.createJob=function(options,callback){++cov_1htbr4vqnm.f[21];++cov_1htbr4vqnm.s[112];options=_.assign({course_id:null,course_instance_id:null,assessment_id:null,user_id:null,authn_user_id:null,job_sequence_id:null,last_in_sequence:false,type:null,description:null,command:null,arguments:[],working_directory:undefined,on_error:undefined,on_success:undefined},options);var params=(++cov_1htbr4vqnm.s[113],{course_id:options.course_id,course_instance_id:options.course_instance_id,assessment_id:options.assessment_id,user_id:options.user_id,authn_user_id:options.authn_user_id,job_sequence_id:options.job_sequence_id,last_in_sequence:options.last_in_sequence,type:options.type,description:options.description,command:options.command,arguments:options.arguments,working_directory:options.working_directory});++cov_1htbr4vqnm.s[114];sqldb.queryOneRow(sql.insert_job,params,function(err,result){++cov_1htbr4vqnm.f[22];++cov_1htbr4vqnm.s[115];if(ERR(err,callback)){++cov_1htbr4vqnm.b[19][0];++cov_1htbr4vqnm.s[116];return;}else{++cov_1htbr4vqnm.b[19][1];}var job_id=(++cov_1htbr4vqnm.s[117],result.rows[0].id);var job=(++cov_1htbr4vqnm.s[118],new Job(job_id,options));++cov_1htbr4vqnm.s[119];module.exports.liveJobs[job_id]=job;++cov_1htbr4vqnm.s[120];if(job.options.job_sequence_id!=null){++cov_1htbr4vqnm.b[20][0];++cov_1htbr4vqnm.s[121];socketServer.io.to('jobSequence-'+job.options.job_sequence_id).emit('update');}else{++cov_1htbr4vqnm.b[20][1];}++cov_1htbr4vqnm.s[122];callback(null,job);});};++cov_1htbr4vqnm.s[123];module.exports.spawnJob=function(options,callback){++cov_1htbr4vqnm.f[23];++cov_1htbr4vqnm.s[124];module.exports.createJob(options,function(err,job){++cov_1htbr4vqnm.f[24];++cov_1htbr4vqnm.s[125];if(ERR(err,callback)){++cov_1htbr4vqnm.b[21][0];++cov_1htbr4vqnm.s[126];return;}else{++cov_1htbr4vqnm.b[21][1];}var spawnOptions=(++cov_1htbr4vqnm.s[127],{cwd:job.options.working_directory});++cov_1htbr4vqnm.s[128];job.proc=child_process.spawn(job.options.command,job.options.arguments,spawnOptions);++cov_1htbr4vqnm.s[129];job.proc.stderr.setEncoding('utf8');++cov_1htbr4vqnm.s[130];job.proc.stdout.setEncoding('utf8');++cov_1htbr4vqnm.s[131];job.proc.stderr.on('data',function(text){++cov_1htbr4vqnm.f[25];++cov_1htbr4vqnm.s[132];job.addToStderr(text);});++cov_1htbr4vqnm.s[133];job.proc.stdout.on('data',function(text){++cov_1htbr4vqnm.f[26];++cov_1htbr4vqnm.s[134];job.addToStdout(text);});++cov_1htbr4vqnm.s[135];job.proc.stderr.on('error',function(err){++cov_1htbr4vqnm.f[27];++cov_1htbr4vqnm.s[136];job.addToStderr('ERROR: '+err.toString()+'\n');});++cov_1htbr4vqnm.s[137];job.proc.stdout.on('error',function(){++cov_1htbr4vqnm.f[28];++cov_1htbr4vqnm.s[138];job.addToStderr('ERROR: '+err.toString()+'\n');});// when a process exists, first 'exit' is fired with stdio
// streams possibly still open, then 'close' is fired once all
// stdio is done
++cov_1htbr4vqnm.s[139];job.proc.on('exit',function(_code,_signal){/* do nothing */++cov_1htbr4vqnm.f[29];});++cov_1htbr4vqnm.s[140];job.proc.on('close',function(code,signal){++cov_1htbr4vqnm.f[30];++cov_1htbr4vqnm.s[141];job.finish(code,signal);});++cov_1htbr4vqnm.s[142];job.proc.on('error',function(err){++cov_1htbr4vqnm.f[31];++cov_1htbr4vqnm.s[143];job.fail(err);});++cov_1htbr4vqnm.s[144];if(callback){++cov_1htbr4vqnm.b[22][0];++cov_1htbr4vqnm.s[145];callback(null,job);}else{++cov_1htbr4vqnm.b[22][1];}});};++cov_1htbr4vqnm.s[146];module.exports.killJob=function(job_id,callback){++cov_1htbr4vqnm.f[32];var job=(++cov_1htbr4vqnm.s[147],module.exports.liveJobs[job_id]);++cov_1htbr4vqnm.s[148];if(!job){++cov_1htbr4vqnm.b[23][0];++cov_1htbr4vqnm.s[149];return callback(new Error('No such job_id: '+job_id));}else{++cov_1htbr4vqnm.b[23][1];}++cov_1htbr4vqnm.s[150];if(!job.proc){++cov_1htbr4vqnm.b[24][0];++cov_1htbr4vqnm.s[151];return callback(new Error('job_id '+job_id+' does not have proc to kill'));}else{++cov_1htbr4vqnm.b[24][1];}++cov_1htbr4vqnm.s[152];job.proc.kill();// this will not fire the usual on_error event on job fail
++cov_1htbr4vqnm.s[153];job.fail('Killed by user',function(err){++cov_1htbr4vqnm.f[33];++cov_1htbr4vqnm.s[154];if(ERR(err,callback)){++cov_1htbr4vqnm.b[25][0];++cov_1htbr4vqnm.s[155];return;}else{++cov_1htbr4vqnm.b[25][1];}++cov_1htbr4vqnm.s[156];callback(null);});};++cov_1htbr4vqnm.s[157];module.exports.errorAbandonedJobs=function(callback){++cov_1htbr4vqnm.f[34];++cov_1htbr4vqnm.s[158];sqldb.query(sql.select_running_jobs,[],function(err,result){++cov_1htbr4vqnm.f[35];++cov_1htbr4vqnm.s[159];if(ERR(err,callback)){++cov_1htbr4vqnm.b[26][0];++cov_1htbr4vqnm.s[160];return;}else{++cov_1htbr4vqnm.b[26][1];}++cov_1htbr4vqnm.s[161];async.each(result.rows,function(row,callback){++cov_1htbr4vqnm.f[36];++cov_1htbr4vqnm.s[162];if(!_.has(module.exports.liveJobs,row.id)){++cov_1htbr4vqnm.b[27][0];++cov_1htbr4vqnm.s[163];logger.debug('Job abandoned by server, id: '+row.id);var params=(++cov_1htbr4vqnm.s[164],{job_id:row.id,stderr:null,stdout:null,output:null,error_message:'Job abandoned by server'});++cov_1htbr4vqnm.s[165];sqldb.query(sql.update_job_on_error,params,function(err,_result){++cov_1htbr4vqnm.f[37];++cov_1htbr4vqnm.s[166];socketServer.io.to('job-'+row.id).emit('update');++cov_1htbr4vqnm.s[167];if(row.job_sequence_id!=null){++cov_1htbr4vqnm.b[28][0];++cov_1htbr4vqnm.s[168];socketServer.io.to('jobSequence-'+row.job_sequence_id).emit('update');}else{++cov_1htbr4vqnm.b[28][1];}++cov_1htbr4vqnm.s[169];if(ERR(err,function(){++cov_1htbr4vqnm.f[38];})){++cov_1htbr4vqnm.b[29][0];++cov_1htbr4vqnm.s[170];logger.error('errorAbandonedJobs: error updating job on error',err);}else{++cov_1htbr4vqnm.b[29][1];}++cov_1htbr4vqnm.s[171];callback(null);});}else{++cov_1htbr4vqnm.b[27][1];}},function(err){++cov_1htbr4vqnm.f[39];++cov_1htbr4vqnm.s[172];if(ERR(err,callback)){++cov_1htbr4vqnm.b[30][0];++cov_1htbr4vqnm.s[173];return;}else{++cov_1htbr4vqnm.b[30][1];}++cov_1htbr4vqnm.s[174];sqldb.query(sql.error_abandoned_job_sequences,[],function(err,result){++cov_1htbr4vqnm.f[40];++cov_1htbr4vqnm.s[175];if(ERR(err,callback)){++cov_1htbr4vqnm.b[31][0];++cov_1htbr4vqnm.s[176];return;}else{++cov_1htbr4vqnm.b[31][1];}++cov_1htbr4vqnm.s[177];result.rows.forEach(function(row){++cov_1htbr4vqnm.f[41];++cov_1htbr4vqnm.s[178];socketServer.io.to('jobSequence-'+row.id).emit('update');});++cov_1htbr4vqnm.s[179];callback(null);});});});};++cov_1htbr4vqnm.s[180];module.exports.createJobSequence=function(options,callback){++cov_1htbr4vqnm.f[42];++cov_1htbr4vqnm.s[181];options=_.assign({course_id:null,course_instance_id:null,assessment_id:null,user_id:null,authn_user_id:null,type:null,description:null},options);var params=(++cov_1htbr4vqnm.s[182],{course_id:options.course_id,course_instance_id:options.course_instance_id,assessment_id:options.assessment_id,user_id:options.user_id,authn_user_id:options.authn_user_id,type:options.type,description:options.description});++cov_1htbr4vqnm.s[183];sqldb.queryOneRow(sql.insert_job_sequence,params,function(err,result){++cov_1htbr4vqnm.f[43];++cov_1htbr4vqnm.s[184];if(ERR(err,callback)){++cov_1htbr4vqnm.b[32][0];++cov_1htbr4vqnm.s[185];return;}else{++cov_1htbr4vqnm.b[32][1];}var job_sequence_id=(++cov_1htbr4vqnm.s[186],result.rows[0].id);++cov_1htbr4vqnm.s[187];callback(null,job_sequence_id);});};++cov_1htbr4vqnm.s[188];module.exports.failJobSequence=function(job_sequence_id,callback){++cov_1htbr4vqnm.f[44];var params=(++cov_1htbr4vqnm.s[189],{job_sequence_id});++cov_1htbr4vqnm.s[190];sqldb.query(sql.fail_job_sequence,params,function(err,_result){++cov_1htbr4vqnm.f[45];++cov_1htbr4vqnm.s[191];socketServer.io.to('jobSequence-'+job_sequence_id).emit('update');++cov_1htbr4vqnm.s[192];if(ERR(err,()=>{++cov_1htbr4vqnm.f[46];})){++cov_1htbr4vqnm.b[33][0];++cov_1htbr4vqnm.s[193];logger.error('error failing job_sequence_id '+job_sequence_id+' with error',err);++cov_1htbr4vqnm.s[194];if(callback){++cov_1htbr4vqnm.b[34][0];++cov_1htbr4vqnm.s[195];return callback(err);}else{++cov_1htbr4vqnm.b[34][1];}}else{++cov_1htbr4vqnm.b[33][1];++cov_1htbr4vqnm.s[196];if(callback){++cov_1htbr4vqnm.b[35][0];++cov_1htbr4vqnm.s[197];return callback(null);}else{++cov_1htbr4vqnm.b[35][1];}}});};