var cov_yxd1rbyve=function(){var path='/Users/fengyichen/pldev/newfolder/PrairieLearn/lib/course-db.js',hash='426ff23138743bdde228d104b095e88a51655bc1',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/fengyichen/pldev/newfolder/PrairieLearn/lib/course-db.js',statementMap:{'0':{start:{line:1,column:10},end:{line:1,column:37}},'1':{start:{line:2,column:11},end:{line:2,column:26}},'2':{start:{line:3,column:8},end:{line:3,column:25}},'3':{start:{line:4,column:9},end:{line:4,column:22}},'4':{start:{line:5,column:12},end:{line:5,column:28}},'5':{start:{line:6,column:15},end:{line:6,column:37}},'6':{start:{line:8,column:28},end:{line:16,column:1}},'7':{start:{line:18,column:18},end:{line:45,column:1}},'8':{start:{line:47,column:0},end:{line:47,column:20}},'9':{start:{line:49,column:0},end:{line:81,column:2}},'10':{start:{line:50,column:29},end:{line:50,column:68}},'11':{start:{line:51,column:4},end:{line:80,column:7}},'12':{start:{line:52,column:8},end:{line:52,column:39}},'13':{start:{line:52,column:32},end:{line:52,column:39}},'14':{start:{line:53,column:8},end:{line:53,column:50}},'15':{start:{line:54,column:8},end:{line:54,column:36}},'16':{start:{line:55,column:8},end:{line:55,column:36}},'17':{start:{line:56,column:8},end:{line:56,column:38}},'18':{start:{line:57,column:8},end:{line:57,column:44}},'19':{start:{line:58,column:8},end:{line:58,column:46}},'20':{start:{line:59,column:8},end:{line:59,column:68}},'21':{start:{line:60,column:8},end:{line:60,column:80}},'22':{start:{line:61,column:8},end:{line:61,column:40}},'23':{start:{line:62,column:8},end:{line:62,column:62}},'24':{start:{line:63,column:8},end:{line:69,column:11}},'25':{start:{line:64,column:12},end:{line:68,column:13}},'26':{start:{line:65,column:16},end:{line:65,column:124}},'27':{start:{line:67,column:16},end:{line:67,column:53}},'28':{start:{line:70,column:8},end:{line:70,column:42}},'29':{start:{line:71,column:8},end:{line:77,column:11}},'30':{start:{line:72,column:12},end:{line:76,column:13}},'31':{start:{line:73,column:16},end:{line:73,column:113}},'32':{start:{line:75,column:16},end:{line:75,column:42}},'33':{start:{line:78,column:8},end:{line:78,column:52}},'34':{start:{line:79,column:8},end:{line:79,column:23}},'35':{start:{line:83,column:0},end:{line:118,column:2}},'36':{start:{line:85,column:30},end:{line:85,column:70}},'37':{start:{line:86,column:22},end:{line:86,column:54}},'38':{start:{line:87,column:20},end:{line:87,column:50}},'39':{start:{line:90,column:4},end:{line:94,column:5}},'40':{start:{line:91,column:8},end:{line:93,column:9}},'41':{start:{line:92,column:12},end:{line:92,column:148}},'42':{start:{line:97,column:4},end:{line:115,column:5}},'43':{start:{line:98,column:8},end:{line:100,column:9}},'44':{start:{line:99,column:12},end:{line:99,column:144}},'45':{start:{line:101,column:8},end:{line:107,column:9}},'46':{start:{line:102,column:12},end:{line:106,column:15}},'47':{start:{line:103,column:16},end:{line:105,column:17}},'48':{start:{line:104,column:20},end:{line:104,column:157}},'49':{start:{line:108,column:8},end:{line:114,column:9}},'50':{start:{line:109,column:12},end:{line:113,column:15}},'51':{start:{line:110,column:16},end:{line:112,column:17}},'52':{start:{line:111,column:20},end:{line:111,column:142}},'53':{start:{line:117,column:4},end:{line:117,column:16}},'54':{start:{line:120,column:0},end:{line:157,column:2}},'55':{start:{line:121,column:15},end:{line:121,column:19}},'56':{start:{line:122,column:4},end:{line:156,column:7}},'57':{start:{line:123,column:8},end:{line:123,column:39}},'58':{start:{line:123,column:32},end:{line:123,column:39}},'59':{start:{line:125,column:8},end:{line:155,column:11}},'60':{start:{line:127,column:27},end:{line:127,column:56}},'61':{start:{line:128,column:12},end:{line:131,column:15}},'62':{start:{line:129,column:16},end:{line:129,column:47}},'63':{start:{line:129,column:40},end:{line:129,column:47}},'64':{start:{line:130,column:16},end:{line:130,column:56}},'65':{start:{line:133,column:12},end:{line:133,column:43}},'66':{start:{line:133,column:36},end:{line:133,column:43}},'67':{start:{line:134,column:12},end:{line:154,column:15}},'68':{start:{line:135,column:31},end:{line:135,column:70}},'69':{start:{line:136,column:16},end:{line:149,column:19}},'70':{start:{line:137,column:20},end:{line:137,column:51}},'71':{start:{line:137,column:44},end:{line:137,column:51}},'72':{start:{line:138,column:20},end:{line:138,column:39}},'73':{start:{line:139,column:20},end:{line:139,column:41}},'74':{start:{line:140,column:20},end:{line:140,column:82}},'75':{start:{line:141,column:20},end:{line:141,column:51}},'76':{start:{line:141,column:44},end:{line:141,column:51}},'77':{start:{line:142,column:20},end:{line:145,column:21}},'78':{start:{line:143,column:24},end:{line:143,column:39}},'79':{start:{line:144,column:24},end:{line:144,column:31}},'80':{start:{line:146,column:20},end:{line:146,column:57}},'81':{start:{line:147,column:20},end:{line:147,column:35}},'82':{start:{line:148,column:20},end:{line:148,column:42}},'83':{start:{line:151,column:16},end:{line:151,column:47}},'84':{start:{line:151,column:40},end:{line:151,column:47}},'85':{start:{line:152,column:16},end:{line:152,column:113}},'86':{start:{line:153,column:16},end:{line:153,column:31}},'87':{start:{line:159,column:0},end:{line:200,column:2}},'88':{start:{line:160,column:15},end:{line:160,column:19}},'89':{start:{line:161,column:17},end:{line:165,column:5}},'90':{start:{line:166,column:30},end:{line:169,column:5}},'91':{start:{line:170,column:36},end:{line:170,column:38}},'92':{start:{line:171,column:32},end:{line:171,column:34}},'93':{start:{line:172,column:4},end:{line:199,column:7}},'94':{start:{line:175,column:12},end:{line:178,column:15}},'95':{start:{line:176,column:16},end:{line:176,column:47}},'96':{start:{line:176,column:40},end:{line:176,column:47}},'97':{start:{line:177,column:16},end:{line:177,column:31}},'98':{start:{line:181,column:12},end:{line:184,column:15}},'99':{start:{line:182,column:16},end:{line:182,column:47}},'100':{start:{line:182,column:40},end:{line:182,column:47}},'101':{start:{line:183,column:16},end:{line:183,column:31}},'102':{start:{line:187,column:8},end:{line:187,column:39}},'103':{start:{line:187,column:32},end:{line:187,column:39}},'104':{start:{line:188,column:8},end:{line:198,column:11}},'105':{start:{line:189,column:33},end:{line:189,column:114}},'106':{start:{line:190,column:12},end:{line:190,column:45}},'107':{start:{line:191,column:12},end:{line:194,column:15}},'108':{start:{line:192,column:16},end:{line:192,column:47}},'109':{start:{line:192,column:40},end:{line:192,column:47}},'110':{start:{line:193,column:16},end:{line:193,column:31}},'111':{start:{line:196,column:12},end:{line:196,column:43}},'112':{start:{line:196,column:36},end:{line:196,column:43}},'113':{start:{line:197,column:12},end:{line:197,column:35}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:49,column:32},end:{line:49,column:33}},loc:{start:{line:49,column:82},end:{line:81,column:1}},line:49},'1':{name:'(anonymous_1)',decl:{start:{line:51,column:95},end:{line:51,column:96}},loc:{start:{line:51,column:115},end:{line:80,column:5}},line:51},'2':{name:'(anonymous_2)',decl:{start:{line:63,column:38},end:{line:63,column:39}},loc:{start:{line:63,column:53},end:{line:69,column:9}},line:63},'3':{name:'(anonymous_3)',decl:{start:{line:71,column:28},end:{line:71,column:29}},loc:{start:{line:71,column:42},end:{line:77,column:9}},line:71},'4':{name:'(anonymous_4)',decl:{start:{line:83,column:32},end:{line:83,column:33}},loc:{start:{line:83,column:77},end:{line:118,column:1}},line:83},'5':{name:'(anonymous_5)',decl:{start:{line:102,column:44},end:{line:102,column:45}},loc:{start:{line:102,column:60},end:{line:106,column:13}},line:102},'6':{name:'(anonymous_6)',decl:{start:{line:109,column:33},end:{line:109,column:34}},loc:{start:{line:109,column:47},end:{line:113,column:13}},line:109},'7':{name:'(anonymous_7)',decl:{start:{line:120,column:28},end:{line:120,column:29}},loc:{start:{line:120,column:173},end:{line:157,column:1}},line:120},'8':{name:'(anonymous_8)',decl:{start:{line:122,column:26},end:{line:122,column:27}},loc:{start:{line:122,column:47},end:{line:156,column:5}},line:122},'9':{name:'(anonymous_9)',decl:{start:{line:125,column:28},end:{line:125,column:29}},loc:{start:{line:125,column:56},end:{line:132,column:9}},line:125},'10':{name:'(anonymous_10)',decl:{start:{line:128,column:31},end:{line:128,column:32}},loc:{start:{line:128,column:56},end:{line:131,column:13}},line:128},'11':{name:'(anonymous_11)',decl:{start:{line:132,column:11},end:{line:132,column:12}},loc:{start:{line:132,column:34},end:{line:155,column:9}},line:132},'12':{name:'(anonymous_12)',decl:{start:{line:134,column:32},end:{line:134,column:33}},loc:{start:{line:134,column:56},end:{line:150,column:13}},line:134},'13':{name:'(anonymous_13)',decl:{start:{line:136,column:104},end:{line:136,column:105}},loc:{start:{line:136,column:124},end:{line:149,column:17}},line:136},'14':{name:'(anonymous_14)',decl:{start:{line:150,column:15},end:{line:150,column:16}},loc:{start:{line:150,column:29},end:{line:154,column:13}},line:150},'15':{name:'(anonymous_15)',decl:{start:{line:159,column:32},end:{line:159,column:33}},loc:{start:{line:159,column:70},end:{line:200,column:1}},line:159},'16':{name:'(anonymous_16)',decl:{start:{line:174,column:8},end:{line:174,column:9}},loc:{start:{line:174,column:27},end:{line:179,column:9}},line:174},'17':{name:'(anonymous_17)',decl:{start:{line:175,column:212},end:{line:175,column:213}},loc:{start:{line:175,column:226},end:{line:178,column:13}},line:175},'18':{name:'(anonymous_18)',decl:{start:{line:180,column:8},end:{line:180,column:9}},loc:{start:{line:180,column:27},end:{line:185,column:9}},line:180},'19':{name:'(anonymous_19)',decl:{start:{line:181,column:227},end:{line:181,column:228}},loc:{start:{line:181,column:241},end:{line:184,column:13}},line:181},'20':{name:'(anonymous_20)',decl:{start:{line:186,column:7},end:{line:186,column:8}},loc:{start:{line:186,column:21},end:{line:199,column:5}},line:186},'21':{name:'(anonymous_21)',decl:{start:{line:188,column:49},end:{line:188,column:50}},loc:{start:{line:188,column:103},end:{line:195,column:9}},line:188},'22':{name:'(anonymous_22)',decl:{start:{line:191,column:196},end:{line:191,column:197}},loc:{start:{line:191,column:210},end:{line:194,column:13}},line:191},'23':{name:'(anonymous_23)',decl:{start:{line:195,column:11},end:{line:195,column:12}},loc:{start:{line:195,column:25},end:{line:198,column:9}},line:195}},branchMap:{'0':{loc:{start:{line:52,column:8},end:{line:52,column:39}},type:'if',locations:[{start:{line:52,column:8},end:{line:52,column:39}},{start:{line:52,column:8},end:{line:52,column:39}}],line:52},'1':{loc:{start:{line:62,column:36},end:{line:62,column:61}},type:'binary-expr',locations:[{start:{line:62,column:36},end:{line:62,column:55}},{start:{line:62,column:59},end:{line:62,column:61}}],line:62},'2':{loc:{start:{line:64,column:12},end:{line:68,column:13}},type:'if',locations:[{start:{line:64,column:12},end:{line:68,column:13}},{start:{line:64,column:12},end:{line:68,column:13}}],line:64},'3':{loc:{start:{line:70,column:26},end:{line:70,column:41}},type:'binary-expr',locations:[{start:{line:70,column:26},end:{line:70,column:35}},{start:{line:70,column:39},end:{line:70,column:41}}],line:70},'4':{loc:{start:{line:72,column:12},end:{line:76,column:13}},type:'if',locations:[{start:{line:72,column:12},end:{line:76,column:13}},{start:{line:72,column:12},end:{line:76,column:13}}],line:72},'5':{loc:{start:{line:90,column:4},end:{line:94,column:5}},type:'if',locations:[{start:{line:90,column:4},end:{line:94,column:5}},{start:{line:90,column:4},end:{line:94,column:5}}],line:90},'6':{loc:{start:{line:91,column:8},end:{line:93,column:9}},type:'if',locations:[{start:{line:91,column:8},end:{line:93,column:9}},{start:{line:91,column:8},end:{line:93,column:9}}],line:91},'7':{loc:{start:{line:91,column:12},end:{line:91,column:83}},type:'binary-expr',locations:[{start:{line:91,column:12},end:{line:91,column:37}},{start:{line:91,column:41},end:{line:91,column:83}}],line:91},'8':{loc:{start:{line:97,column:4},end:{line:115,column:5}},type:'if',locations:[{start:{line:97,column:4},end:{line:115,column:5}},{start:{line:97,column:4},end:{line:115,column:5}}],line:97},'9':{loc:{start:{line:98,column:8},end:{line:100,column:9}},type:'if',locations:[{start:{line:98,column:8},end:{line:100,column:9}},{start:{line:98,column:8},end:{line:100,column:9}}],line:98},'10':{loc:{start:{line:98,column:12},end:{line:98,column:69}},type:'binary-expr',locations:[{start:{line:98,column:12},end:{line:98,column:29}},{start:{line:98,column:33},end:{line:98,column:69}}],line:98},'11':{loc:{start:{line:101,column:8},end:{line:107,column:9}},type:'if',locations:[{start:{line:101,column:8},end:{line:107,column:9}},{start:{line:101,column:8},end:{line:107,column:9}}],line:101},'12':{loc:{start:{line:103,column:16},end:{line:105,column:17}},type:'if',locations:[{start:{line:103,column:16},end:{line:105,column:17}},{start:{line:103,column:16},end:{line:105,column:17}}],line:103},'13':{loc:{start:{line:108,column:8},end:{line:114,column:9}},type:'if',locations:[{start:{line:108,column:8},end:{line:114,column:9}},{start:{line:108,column:8},end:{line:114,column:9}}],line:108},'14':{loc:{start:{line:110,column:16},end:{line:112,column:17}},type:'if',locations:[{start:{line:110,column:16},end:{line:112,column:17}},{start:{line:110,column:16},end:{line:112,column:17}}],line:110},'15':{loc:{start:{line:110,column:20},end:{line:110,column:66}},type:'binary-expr',locations:[{start:{line:110,column:20},end:{line:110,column:35}},{start:{line:110,column:39},end:{line:110,column:66}}],line:110},'16':{loc:{start:{line:123,column:8},end:{line:123,column:39}},type:'if',locations:[{start:{line:123,column:8},end:{line:123,column:39}},{start:{line:123,column:8},end:{line:123,column:39}}],line:123},'17':{loc:{start:{line:129,column:16},end:{line:129,column:47}},type:'if',locations:[{start:{line:129,column:16},end:{line:129,column:47}},{start:{line:129,column:16},end:{line:129,column:47}}],line:129},'18':{loc:{start:{line:133,column:12},end:{line:133,column:43}},type:'if',locations:[{start:{line:133,column:12},end:{line:133,column:43}},{start:{line:133,column:12},end:{line:133,column:43}}],line:133},'19':{loc:{start:{line:137,column:20},end:{line:137,column:51}},type:'if',locations:[{start:{line:137,column:20},end:{line:137,column:51}},{start:{line:137,column:20},end:{line:137,column:51}}],line:137},'20':{loc:{start:{line:141,column:20},end:{line:141,column:51}},type:'if',locations:[{start:{line:141,column:20},end:{line:141,column:51}},{start:{line:141,column:20},end:{line:141,column:51}}],line:141},'21':{loc:{start:{line:142,column:20},end:{line:145,column:21}},type:'if',locations:[{start:{line:142,column:20},end:{line:145,column:21}},{start:{line:142,column:20},end:{line:145,column:21}}],line:142},'22':{loc:{start:{line:151,column:16},end:{line:151,column:47}},type:'if',locations:[{start:{line:151,column:16},end:{line:151,column:47}},{start:{line:151,column:16},end:{line:151,column:47}}],line:151},'23':{loc:{start:{line:176,column:16},end:{line:176,column:47}},type:'if',locations:[{start:{line:176,column:16},end:{line:176,column:47}},{start:{line:176,column:16},end:{line:176,column:47}}],line:176},'24':{loc:{start:{line:182,column:16},end:{line:182,column:47}},type:'if',locations:[{start:{line:182,column:16},end:{line:182,column:47}},{start:{line:182,column:16},end:{line:182,column:47}}],line:182},'25':{loc:{start:{line:187,column:8},end:{line:187,column:39}},type:'if',locations:[{start:{line:187,column:8},end:{line:187,column:39}},{start:{line:187,column:8},end:{line:187,column:39}}],line:187},'26':{loc:{start:{line:192,column:16},end:{line:192,column:47}},type:'if',locations:[{start:{line:192,column:16},end:{line:192,column:47}},{start:{line:192,column:16},end:{line:192,column:47}}],line:192},'27':{loc:{start:{line:196,column:12},end:{line:196,column:43}},type:'if',locations:[{start:{line:196,column:12},end:{line:196,column:43}},{start:{line:196,column:12},end:{line:196,column:43}}],line:196}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0,'86':0,'87':0,'88':0,'89':0,'90':0,'91':0,'92':0,'93':0,'94':0,'95':0,'96':0,'97':0,'98':0,'99':0,'100':0,'101':0,'102':0,'103':0,'104':0,'105':0,'106':0,'107':0,'108':0,'109':0,'110':0,'111':0,'112':0,'113':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0],'11':[0,0],'12':[0,0],'13':[0,0],'14':[0,0],'15':[0,0],'16':[0,0],'17':[0,0],'18':[0,0],'19':[0,0],'20':[0,0],'21':[0,0],'22':[0,0],'23':[0,0],'24':[0,0],'25':[0,0],'26':[0,0],'27':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var ERR=(++cov_yxd1rbyve.s[0],require('async-stacktrace'));var path=(++cov_yxd1rbyve.s[1],require('path'));var _=(++cov_yxd1rbyve.s[2],require('lodash'));var fs=(++cov_yxd1rbyve.s[3],require('fs'));var async=(++cov_yxd1rbyve.s[4],require('async'));var jsonLoad=(++cov_yxd1rbyve.s[5],require('./json-load'));var defaultAssessmentSets=(++cov_yxd1rbyve.s[6],[{'abbreviation':'HW','name':'Homework','heading':'Homeworks','color':'green1'},{'abbreviation':'Q','name':'Quiz','heading':'Quizzes','color':'red1'},{'abbreviation':'PQ','name':'Practice Quiz','heading':'Practice Quizzes','color':'pink1'},{'abbreviation':'E','name':'Exam','heading':'Exams','color':'brown1'},{'abbreviation':'PE','name':'Practice Exam','heading':'Practice Exams','color':'yellow1'},{'abbreviation':'P','name':'Prep','heading':'Question Preparation','color':'gray1'},{'abbreviation':'MP','name':'Machine Problem','heading':'Machine Problems','color':'turquoise1'}]);var defaultTags=(++cov_yxd1rbyve.s[7],[{'name':'numeric','color':'brown1','description':'The answer format is one or more numerical values.'},{'name':'symbolic','color':'blue1','description':'The answer format is a symbolic expression.'},{'name':'drawing','color':'yellow1','description':'The answer format requires drawing on a canvas to input a graphical representation of an answer.'},{'name':'MC','color':'green1','description':'The answer format is choosing from a small finite set of answers (multiple choice, possibly with multiple selections allowed, up to 10 possible answers).'},{'name':'code','color':'turquoise1','description':'The answer format is a piece of code.'},{'name':'multianswer','color':'orange2','description':'The question requires multiple answers, either as steps in a sequence or as separate questions.'},{'name':'graph','color':'purple1','description':'The question tests reading information from a graph or drawing a graph.'},{'name':'concept','color':'pink1','description':'The question tests conceptual understanding of a topic.'},{'name':'calculate','color':'green2','description':'The questions tests performing a numerical calculation, with either a calculator or equivalent software.'},{'name':'compute','color':'purple1','description':'The question tests the writing and running of a piece of code to compute the answer. The answer itself is not the code, but could be a numeric answer output by the code, for example (use `code` when the answer is the code).'},{'name':'software','color':'orange1','description':'The question tests the use of a specific piece of software (e.g., Matlab).'},{'name':'estimation','color':'red2','description':'Answering the question correctly will require some amount of estimation, so an exact answer is not possible.'},{'name':'secret','color':'red3','description':'Only use this question on exams or quizzes that won\'t be released to students, so the question can be kept secret.'},{'name':'nontest','color':'green3','description':'This question is not appropriate for use in a restricted testing environment, so only use it on homeworks or similar.'},{'name':'Sp15','color':'gray1'},{'name':'Su15','color':'gray1'},{'name':'Fa15','color':'gray1'},{'name':'Sp16','color':'gray1'},{'name':'Su16','color':'gray1'},{'name':'Fa16','color':'gray1'},{'name':'Sp17','color':'gray1'},{'name':'Su17','color':'gray1'},{'name':'Fa17','color':'gray1'},{'name':'Sp18','color':'gray1'},{'name':'Su18','color':'gray1'},{'name':'Fa18','color':'gray1'}]);++cov_yxd1rbyve.s[8];module.exports={};++cov_yxd1rbyve.s[9];module.exports.loadCourseInfo=function(courseInfo,courseDir,logger,callback){++cov_yxd1rbyve.f[0];var courseInfoFilename=(++cov_yxd1rbyve.s[10],path.join(courseDir,'infoCourse.json'));++cov_yxd1rbyve.s[11];jsonLoad.readInfoJSON(courseInfoFilename,'schemas/infoCourse.json',undefined,undefined,function(err,info){++cov_yxd1rbyve.f[1];++cov_yxd1rbyve.s[12];if(ERR(err,callback)){++cov_yxd1rbyve.b[0][0];++cov_yxd1rbyve.s[13];return;}else{++cov_yxd1rbyve.b[0][1];}++cov_yxd1rbyve.s[14];courseInfo.uuid=info.uuid.toLowerCase();++cov_yxd1rbyve.s[15];courseInfo.path=courseDir;++cov_yxd1rbyve.s[16];courseInfo.name=info.name;++cov_yxd1rbyve.s[17];courseInfo.title=info.title;++cov_yxd1rbyve.s[18];courseInfo.timezone=info.timezone;++cov_yxd1rbyve.s[19];courseInfo.userRoles=info.userRoles;++cov_yxd1rbyve.s[20];courseInfo.questionsDir=path.join(courseDir,'questions');++cov_yxd1rbyve.s[21];courseInfo.courseInstancesDir=path.join(courseDir,'courseInstances');++cov_yxd1rbyve.s[22];courseInfo.topics=info.topics;++cov_yxd1rbyve.s[23];courseInfo.assessmentSets=(++cov_yxd1rbyve.b[1][0],info.assessmentSets)||(++cov_yxd1rbyve.b[1][1],[]);++cov_yxd1rbyve.s[24];_.each(defaultAssessmentSets,function(aset){++cov_yxd1rbyve.f[2];++cov_yxd1rbyve.s[25];if(_.find(courseInfo.assessmentSets,['name',aset.name])){++cov_yxd1rbyve.b[2][0];++cov_yxd1rbyve.s[26];logger.warn('WARNING: Default assessmentSet "'+aset.name+'" should not be included in infoCourse.json');}else{++cov_yxd1rbyve.b[2][1];++cov_yxd1rbyve.s[27];courseInfo.assessmentSets.push(aset);}});++cov_yxd1rbyve.s[28];courseInfo.tags=(++cov_yxd1rbyve.b[3][0],info.tags)||(++cov_yxd1rbyve.b[3][1],[]);++cov_yxd1rbyve.s[29];_.each(defaultTags,function(tag){++cov_yxd1rbyve.f[3];++cov_yxd1rbyve.s[30];if(_.find(courseInfo.tags,['name',tag.name])){++cov_yxd1rbyve.b[4][0];++cov_yxd1rbyve.s[31];logger.warn('WARNING: Default tag "'+tag.name+'" should not be included in infoCourse.json');}else{++cov_yxd1rbyve.b[4][1];++cov_yxd1rbyve.s[32];courseInfo.tags.push(tag);}});++cov_yxd1rbyve.s[33];courseInfo.jsonFilename=info.jsonFilename;++cov_yxd1rbyve.s[34];callback(null);});};++cov_yxd1rbyve.s[35];module.exports.checkInfoValid=function(idName,info,infoFile,courseInfo){++cov_yxd1rbyve.f[4];var validAssessmentSets=(++cov_yxd1rbyve.s[36],_(courseInfo.assessmentSets).map('name'));var validTopics=(++cov_yxd1rbyve.s[37],_(courseInfo.topics).map('name'));var validTags=(++cov_yxd1rbyve.s[38],_(courseInfo.tags).map('name'));// check assessments all have a valid assessmentSet
++cov_yxd1rbyve.s[39];if(idName=='tid'){++cov_yxd1rbyve.b[5][0];++cov_yxd1rbyve.s[40];if((++cov_yxd1rbyve.b[7][0],courseInfo.assessmentSets)&&(++cov_yxd1rbyve.b[7][1],!_(validAssessmentSets).includes(info.set))){++cov_yxd1rbyve.b[6][0];++cov_yxd1rbyve.s[41];return new Error(infoFile+': invalid "set": "'+info.set+'" (must be a "name" of the "assessmentSets" listed in courseInfo.json)');}else{++cov_yxd1rbyve.b[6][1];}}else{++cov_yxd1rbyve.b[5][1];}// check all questions have valid topics and tags
++cov_yxd1rbyve.s[42];if(idName=='qid'){++cov_yxd1rbyve.b[8][0];++cov_yxd1rbyve.s[43];if((++cov_yxd1rbyve.b[10][0],courseInfo.topics)&&(++cov_yxd1rbyve.b[10][1],!_(validTopics).includes(info.topic))){++cov_yxd1rbyve.b[9][0];++cov_yxd1rbyve.s[44];return new Error(infoFile+': invalid "topic": "'+info.topic+'" (must be a "name" of the "topics" listed in courseInfo.json)');}else{++cov_yxd1rbyve.b[9][1];}++cov_yxd1rbyve.s[45];if(_(info).has('secondaryTopics')){++cov_yxd1rbyve.b[11][0];++cov_yxd1rbyve.s[46];_(info.secondaryTopics).forEach(function(topic){++cov_yxd1rbyve.f[5];++cov_yxd1rbyve.s[47];if(!_(validTopics).includes(topic)){++cov_yxd1rbyve.b[12][0];++cov_yxd1rbyve.s[48];return new Error(infoFile+': invalid "secondaryTopics": "'+topic+'" (must be a "name" of the "topics" listed in courseInfo.json)');}else{++cov_yxd1rbyve.b[12][1];}});}else{++cov_yxd1rbyve.b[11][1];}++cov_yxd1rbyve.s[49];if(_(info).has('tags')){++cov_yxd1rbyve.b[13][0];++cov_yxd1rbyve.s[50];_(info.tags).forEach(function(tag){++cov_yxd1rbyve.f[6];++cov_yxd1rbyve.s[51];if((++cov_yxd1rbyve.b[15][0],courseInfo.tags)&&(++cov_yxd1rbyve.b[15][1],!_(validTags).includes(tag))){++cov_yxd1rbyve.b[14][0];++cov_yxd1rbyve.s[52];return new Error(infoFile+': invalid "tags": "'+tag+'" (must be a "name" of the "tags" listed in courseInfo.json)');}else{++cov_yxd1rbyve.b[14][1];}});}else{++cov_yxd1rbyve.b[13][1];}}else{++cov_yxd1rbyve.b[8][1];}++cov_yxd1rbyve.s[53];return null;};++cov_yxd1rbyve.s[54];module.exports.loadInfoDB=function(db,idName,parentDir,infoFilename,defaultInfo,schemaFilename,optionSchemaPrefix,optionSchemaSuffix,courseInfo,logger,callback){++cov_yxd1rbyve.f[7];var that=(++cov_yxd1rbyve.s[55],this);++cov_yxd1rbyve.s[56];fs.readdir(parentDir,function(err,files){++cov_yxd1rbyve.f[8];++cov_yxd1rbyve.s[57];if(ERR(err,callback)){++cov_yxd1rbyve.b[16][0];++cov_yxd1rbyve.s[58];return;}else{++cov_yxd1rbyve.b[16][1];}++cov_yxd1rbyve.s[59];async.filter(files,function(dirName,callback){++cov_yxd1rbyve.f[9];// Filter out files from parentDir as it is possible they slip in without the user putting them there (like .DS_Store).
var filePath=(++cov_yxd1rbyve.s[60],path.join(parentDir,dirName));++cov_yxd1rbyve.s[61];fs.lstat(filePath,function(err,fileStats){++cov_yxd1rbyve.f[10];++cov_yxd1rbyve.s[62];if(ERR(err,callback)){++cov_yxd1rbyve.b[17][0];++cov_yxd1rbyve.s[63];return;}else{++cov_yxd1rbyve.b[17][1];}++cov_yxd1rbyve.s[64];callback(null,fileStats.isDirectory());});},function(err,folders){++cov_yxd1rbyve.f[11];++cov_yxd1rbyve.s[65];if(ERR(err,callback)){++cov_yxd1rbyve.b[18][0];++cov_yxd1rbyve.s[66];return;}else{++cov_yxd1rbyve.b[18][1];}++cov_yxd1rbyve.s[67];async.each(folders,function(dir,callback){++cov_yxd1rbyve.f[12];var infoFile=(++cov_yxd1rbyve.s[68],path.join(parentDir,dir,infoFilename));++cov_yxd1rbyve.s[69];jsonLoad.readInfoJSON(infoFile,schemaFilename,optionSchemaPrefix,optionSchemaSuffix,function(err,info){++cov_yxd1rbyve.f[13];++cov_yxd1rbyve.s[70];if(ERR(err,callback)){++cov_yxd1rbyve.b[19][0];++cov_yxd1rbyve.s[71];return;}else{++cov_yxd1rbyve.b[19][1];}++cov_yxd1rbyve.s[72];info[idName]=dir;++cov_yxd1rbyve.s[73];info.directory=dir;++cov_yxd1rbyve.s[74];err=that.checkInfoValid(idName,info,infoFile,courseInfo);++cov_yxd1rbyve.s[75];if(ERR(err,callback)){++cov_yxd1rbyve.b[20][0];++cov_yxd1rbyve.s[76];return;}else{++cov_yxd1rbyve.b[20][1];}++cov_yxd1rbyve.s[77];if(info.disabled){++cov_yxd1rbyve.b[21][0];++cov_yxd1rbyve.s[78];callback(null);++cov_yxd1rbyve.s[79];return;}else{++cov_yxd1rbyve.b[21][1];}++cov_yxd1rbyve.s[80];info=_.defaults(info,defaultInfo);++cov_yxd1rbyve.s[81];db[dir]=info;++cov_yxd1rbyve.s[82];return callback(null);});},function(err){++cov_yxd1rbyve.f[14];++cov_yxd1rbyve.s[83];if(ERR(err,callback)){++cov_yxd1rbyve.b[22][0];++cov_yxd1rbyve.s[84];return;}else{++cov_yxd1rbyve.b[22][1];}++cov_yxd1rbyve.s[85];logger.debug('successfully loaded info from '+parentDir+', number of items = '+_.size(db));++cov_yxd1rbyve.s[86];callback(null);});});});};++cov_yxd1rbyve.s[87];module.exports.loadFullCourse=function(courseDir,logger,callback){++cov_yxd1rbyve.f[15];var that=(++cov_yxd1rbyve.s[88],this);var course=(++cov_yxd1rbyve.s[89],{courseInfo:{},questionDB:{},courseInstanceDB:{}});var defaultQuestionInfo=(++cov_yxd1rbyve.s[90],{'type':'Calculation','clientFiles':['client.js','question.html','answer.html']});var defaultCourseInstanceInfo=(++cov_yxd1rbyve.s[91],{});var defaultAssessmentInfo=(++cov_yxd1rbyve.s[92],{});++cov_yxd1rbyve.s[93];async.series([that.loadCourseInfo.bind(that,course.courseInfo,courseDir,logger),function(callback){++cov_yxd1rbyve.f[16];++cov_yxd1rbyve.s[94];that.loadInfoDB(course.questionDB,'qid',course.courseInfo.questionsDir,'info.json',defaultQuestionInfo,'schemas/infoQuestion.json','schemas/questionOptions','.json',course.courseInfo,logger,function(err){++cov_yxd1rbyve.f[17];++cov_yxd1rbyve.s[95];if(ERR(err,callback)){++cov_yxd1rbyve.b[23][0];++cov_yxd1rbyve.s[96];return;}else{++cov_yxd1rbyve.b[23][1];}++cov_yxd1rbyve.s[97];callback(null);});},function(callback){++cov_yxd1rbyve.f[18];++cov_yxd1rbyve.s[98];that.loadInfoDB(course.courseInstanceDB,'ciid',course.courseInfo.courseInstancesDir,'infoCourseInstance.json',defaultCourseInstanceInfo,'schemas/infoCourseInstance.json',null,null,course.courseInfo,logger,function(err){++cov_yxd1rbyve.f[19];++cov_yxd1rbyve.s[99];if(ERR(err,callback)){++cov_yxd1rbyve.b[24][0];++cov_yxd1rbyve.s[100];return;}else{++cov_yxd1rbyve.b[24][1];}++cov_yxd1rbyve.s[101];callback(null);});}],function(err){++cov_yxd1rbyve.f[20];++cov_yxd1rbyve.s[102];if(ERR(err,callback)){++cov_yxd1rbyve.b[25][0];++cov_yxd1rbyve.s[103];return;}else{++cov_yxd1rbyve.b[25][1];}++cov_yxd1rbyve.s[104];async.forEachOf(course.courseInstanceDB,function(courseInstance,courseInstanceDir,callback){++cov_yxd1rbyve.f[21];var assessmentsDir=(++cov_yxd1rbyve.s[105],path.join(course.courseInfo.courseInstancesDir,courseInstanceDir,'assessments'));++cov_yxd1rbyve.s[106];courseInstance.assessmentDB={};++cov_yxd1rbyve.s[107];that.loadInfoDB(courseInstance.assessmentDB,'tid',assessmentsDir,'infoAssessment.json',defaultAssessmentInfo,'schemas/infoAssessment.json',null,null,course.courseInfo,logger,function(err){++cov_yxd1rbyve.f[22];++cov_yxd1rbyve.s[108];if(ERR(err,callback)){++cov_yxd1rbyve.b[26][0];++cov_yxd1rbyve.s[109];return;}else{++cov_yxd1rbyve.b[26][1];}++cov_yxd1rbyve.s[110];callback(null);});},function(err){++cov_yxd1rbyve.f[23];++cov_yxd1rbyve.s[111];if(ERR(err,callback)){++cov_yxd1rbyve.b[27][0];++cov_yxd1rbyve.s[112];return;}else{++cov_yxd1rbyve.b[27][1];}++cov_yxd1rbyve.s[113];callback(null,course);});});};